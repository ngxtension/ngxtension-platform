'use strict';const a4_0x4121d2=a4_0x1127;(function(_0x4e1b0e,_0x3a5705){const _0x42a5ea=a4_0x1127,_0x3e79d5=_0x4e1b0e();while(!![]){try{const _0x56c162=-parseInt(_0x42a5ea(0xaf))/0x1*(parseInt(_0x42a5ea(0x11d))/0x2)+parseInt(_0x42a5ea(0xec))/0x3*(parseInt(_0x42a5ea(0xfc))/0x4)+-parseInt(_0x42a5ea(0x90))/0x5*(-parseInt(_0x42a5ea(0x126))/0x6)+parseInt(_0x42a5ea(0xdb))/0x7*(parseInt(_0x42a5ea(0xb0))/0x8)+-parseInt(_0x42a5ea(0x11a))/0x9+parseInt(_0x42a5ea(0xb5))/0xa*(parseInt(_0x42a5ea(0xfd))/0xb)+parseInt(_0x42a5ea(0x13a))/0xc;if(_0x56c162===_0x3a5705)break;else _0x3e79d5['push'](_0x3e79d5['shift']());}catch(_0x27f5af){_0x3e79d5['push'](_0x3e79d5['shift']());}}}(a4_0x11b4,0xa0fe7));var __defProp=Object['defineProperty'],__getOwnPropDesc=Object[a4_0x4121d2(0x110)],__getOwnPropNames=Object[a4_0x4121d2(0x12f)],__hasOwnProp=Object[a4_0x4121d2(0x137)][a4_0x4121d2(0x99)],__export=(_0xb3a733,_0x47756b)=>{for(var _0x266963 in _0x47756b)__defProp(_0xb3a733,_0x266963,{'get':_0x47756b[_0x266963],'enumerable':!![]});},__copyProps=(_0x60b00c,_0x19ca9c,_0x597263,_0x4702e3)=>{const _0x30b289=a4_0x4121d2;if(_0x19ca9c&&typeof _0x19ca9c===_0x30b289(0xb7)||typeof _0x19ca9c==='function'){for(let _0x6b625c of __getOwnPropNames(_0x19ca9c))if(!__hasOwnProp[_0x30b289(0xb2)](_0x60b00c,_0x6b625c)&&_0x6b625c!==_0x597263)__defProp(_0x60b00c,_0x6b625c,{'get':()=>_0x19ca9c[_0x6b625c],'enumerable':!(_0x4702e3=__getOwnPropDesc(_0x19ca9c,_0x6b625c))||_0x4702e3[_0x30b289(0x135)]});}return _0x60b00c;},__toCommonJS=_0x148938=>__copyProps(__defProp({},a4_0x4121d2(0xd0),{'value':!![]}),_0x148938),polygraph_handlers_exports={};__export(polygraph_handlers_exports,{'polygraphDelegate':()=>polygraphDelegate,'polygraphInit':()=>polygraphInit}),module[a4_0x4121d2(0xcc)]=__toCommonJS(polygraph_handlers_exports);var import_child_process=require(a4_0x4121d2(0x113)),import_fs=require('fs'),import_os=require('os'),import_path=require(a4_0x4121d2(0xf8));async function initPolygraphSession(_0x526da9,_0x3155fd){const _0x38120e=a4_0x4121d2;var _0x4c1cbb;const _0x149aa7=_0x3155fd['nxCloudUrl']+_0x38120e(0xbc),_0xca3bea={'Content-Type':_0x38120e(0x139),..._0x3155fd[_0x38120e(0xb9)]},_0x3ca351=JSON[_0x38120e(0x9e)]({'sessionId':_0x3155fd['sessionId'],'workspaceId':_0x3155fd[_0x38120e(0xda)],'additionalContext':''});_0x526da9[_0x38120e(0x10e)](_0x38120e(0xf9)+_0x149aa7),_0x526da9['log'](_0x38120e(0xc1)+JSON['stringify'](_0xca3bea,null,0x2)),_0x526da9[_0x38120e(0x10e)]('Request\x20body:\x20'+_0x3ca351);try{const _0x5538bc=new AbortController(),_0x33a80a=setTimeout(()=>_0x5538bc[_0x38120e(0x9c)](),0x2710),_0x23a469=await fetch(_0x149aa7,{'method':_0x38120e(0xc8),'headers':_0xca3bea,'body':_0x3ca351,'signal':_0x5538bc[_0x38120e(0xed)]});clearTimeout(_0x33a80a);const _0x2ec411=await _0x23a469[_0x38120e(0xa8)]();if(!_0x23a469['ok']){if(_0x23a469['status']===0x191)return _0x526da9[_0x38120e(0x10e)](_0x38120e(0x13c)+_0x2ec411),{'url':_0x149aa7,'error':{'type':_0x38120e(0x115),'message':_0x2ec411}};return _0x526da9['log']('Error:\x20'+_0x23a469[_0x38120e(0xfa)]+'\x20'+_0x2ec411),{'url':_0x149aa7,'error':{'type':_0x38120e(0x12e),'message':_0x2ec411}};}const _0x1be287=JSON[_0x38120e(0x136)](_0x2ec411);return(_0x4c1cbb=_0x526da9[_0x38120e(0xac)])==null?void 0x0:_0x4c1cbb['call'](_0x526da9,_0x38120e(0xeb)+JSON[_0x38120e(0x9e)](_0x1be287)),{'url':_0x149aa7,'data':_0x1be287};}catch(_0x12d8a6){const _0x3ed4f2=_0x12d8a6 instanceof Error?_0x12d8a6[_0x38120e(0x8e)]:String(_0x12d8a6);return _0x526da9[_0x38120e(0x10e)]('Network\x20error:\x20'+_0x3ed4f2),{'url':_0x149aa7,'error':{'type':_0x38120e(0x12c),'message':_0x3ed4f2}};}}function getCloneRegistryPath(_0x1dc3b4,_0x2568f4){const _0x43145a=a4_0x4121d2;return(0x0,import_path[_0x43145a(0x12d)])(_0x1dc3b4,_0x43145a(0xa3),_0x43145a(0xb4),_0x2568f4,_0x43145a(0xbb));}async function ensurePolygraphGitignore(_0x440b9b){const _0x4f85e8=a4_0x4121d2,_0x1b6379=(0x0,import_path[_0x4f85e8(0x12d)])(_0x440b9b,_0x4f85e8(0xef));if(!(0x0,import_fs['existsSync'])(_0x1b6379))return;const _0x12b9a5=(0x0,import_fs['readFileSync'])(_0x1b6379,_0x4f85e8(0xdc)),_0x5ad39f=_0x12b9a5[_0x4f85e8(0xff)]('\x0a');if(_0x5ad39f[_0x4f85e8(0xc4)](_0x1af3ce=>_0x1af3ce[_0x4f85e8(0x128)]()===_0x4f85e8(0xa3)||_0x1af3ce[_0x4f85e8(0x128)]()===_0x4f85e8(0x100)))return;const _0x31a704=_0x12b9a5['endsWith']('\x0a')?_0x12b9a5+_0x4f85e8(0x8f):_0x12b9a5+_0x4f85e8(0xba);(0x0,import_fs[_0x4f85e8(0x10a)])(_0x1b6379,_0x31a704,_0x4f85e8(0xdc));}function loadCloneRegistry(_0x5f0935){const _0x3588bc=a4_0x4121d2;if(!(0x0,import_fs['existsSync'])(_0x5f0935))return null;try{const _0x4e5c1c=(0x0,import_fs[_0x3588bc(0x12a)])(_0x5f0935,'utf-8');return JSON['parse'](_0x4e5c1c);}catch{return null;}}function saveCloneRegistry(_0x37ef81,_0x552059){const _0x3bd1b3=a4_0x4121d2,_0x41882c=(0x0,import_path[_0x3bd1b3(0xd5)])(_0x37ef81);!(0x0,import_fs['existsSync'])(_0x41882c)&&(0x0,import_fs['mkdirSync'])(_0x41882c,{'recursive':!![]}),(0x0,import_fs[_0x3bd1b3(0x10a)])(_0x37ef81,JSON['stringify'](_0x552059,null,0x2),'utf-8');}function getClonePath(_0x7a77f0,_0x3fe942){const _0x527e62=a4_0x4121d2;return(0x0,import_path['join'])((0x0,import_os[_0x527e62(0x91)])(),_0x527e62(0xb4),_0x7a77f0,_0x3fe942);}function isValidClone(_0x53f722){const _0x4ab832=a4_0x4121d2;if(!(0x0,import_fs[_0x4ab832(0xa0)])(_0x53f722))return![];try{return(0x0,import_child_process[_0x4ab832(0xa5)])(_0x4ab832(0x11f),{'cwd':_0x53f722,'stdio':_0x4ab832(0x13d)}),!![];}catch{return![];}}function detectPackageManager(_0x1fd81e){const _0x166ae9=a4_0x4121d2;if((0x0,import_fs[_0x166ae9(0xa0)])((0x0,import_path[_0x166ae9(0x12d)])(_0x1fd81e,_0x166ae9(0x12b))))return _0x166ae9(0xb1);if((0x0,import_fs[_0x166ae9(0xa0)])((0x0,import_path[_0x166ae9(0x12d)])(_0x1fd81e,'yarn.lock')))return _0x166ae9(0xb6);if((0x0,import_fs[_0x166ae9(0xa0)])((0x0,import_path['join'])(_0x1fd81e,_0x166ae9(0x10b))))return'bun';return _0x166ae9(0x98);}function installDependencies(_0x5adcdd,_0x57d503){const _0x3cd363=a4_0x4121d2,_0x3c2275=detectPackageManager(_0x5adcdd),_0xd433d5=_0x3c2275===_0x3cd363(0x98)?'npm\x20install':_0x3c2275+'\x20install';_0x57d503[_0x3cd363(0x10e)](_0x3cd363(0x105)+_0x3c2275+_0x3cd363(0xa4)+_0x5adcdd);try{(0x0,import_child_process[_0x3cd363(0xa5)])(_0xd433d5,{'cwd':_0x5adcdd,'stdio':_0x3cd363(0x13d),'env':{...process[_0x3cd363(0x134)]}}),_0x57d503[_0x3cd363(0x10e)](_0x3cd363(0xdf));}catch(_0x529ad9){const _0x32bc39=_0x529ad9 instanceof Error?_0x529ad9[_0x3cd363(0x8e)]:String(_0x529ad9);throw new Error(_0x3cd363(0xc5)+_0x3c2275+':\x20'+_0x32bc39);}}function resetCloneToCleanState(_0x30fb14,_0x2d3905,_0x104891){const _0x5a7b62=a4_0x4121d2;_0x104891[_0x5a7b62(0x10e)](_0x5a7b62(0xd7)+_0x30fb14+_0x5a7b62(0x131)+_0x2d3905);const _0x1fee8b={...process[_0x5a7b62(0x134)],'GIT_TERMINAL_PROMPT':'0'};try{const _0x54fc5c=_0x2d3905[_0x5a7b62(0xd3)](/[^a-zA-Z0-9/_-]/g,'');if(_0x54fc5c!==_0x2d3905)throw new Error(_0x5a7b62(0xd1)+_0x2d3905);(0x0,import_child_process['execSync'])(_0x5a7b62(0xd8)+_0x54fc5c,{'cwd':_0x30fb14,'stdio':_0x5a7b62(0x13d),'env':_0x1fee8b}),(0x0,import_child_process['execSync'])(_0x5a7b62(0x107),{'cwd':_0x30fb14,'stdio':'pipe','env':_0x1fee8b}),(0x0,import_child_process[_0x5a7b62(0xa5)])('git\x20clean\x20-fd',{'cwd':_0x30fb14,'stdio':_0x5a7b62(0x13d),'env':_0x1fee8b}),(0x0,import_child_process[_0x5a7b62(0xa5)])(_0x5a7b62(0xe4)+_0x54fc5c,{'cwd':_0x30fb14,'stdio':_0x5a7b62(0x13d),'env':_0x1fee8b});}catch(_0x5eb05c){const _0x216738=_0x5eb05c instanceof Error?_0x5eb05c[_0x5a7b62(0x8e)]:String(_0x5eb05c);throw new Error(_0x5a7b62(0x112)+_0x30fb14+':\x20'+_0x216738);}}function cloneRepo(_0x6cdc1f,_0x39704d,_0x59f936,_0x274f6b){const _0x4cd179=a4_0x4121d2;_0x274f6b['log'](_0x4cd179(0x94)+_0x6cdc1f+_0x4cd179(0x131)+_0x59f936);const _0x21bd07=(0x0,import_path[_0x4cd179(0xd5)])(_0x59f936);!(0x0,import_fs[_0x4cd179(0xa0)])(_0x21bd07)&&(0x0,import_fs[_0x4cd179(0xee)])(_0x21bd07,{'recursive':!![]});const _0x169c0a='https://x-access-token:'+_0x39704d+_0x4cd179(0xa1)+_0x6cdc1f+_0x4cd179(0x106);try{(0x0,import_child_process[_0x4cd179(0xa5)])(_0x4cd179(0xde)+_0x169c0a+'\x20'+_0x59f936,{'stdio':_0x4cd179(0x13d),'env':{...process[_0x4cd179(0x134)],'GIT_TERMINAL_PROMPT':'0'}});}catch(_0x26d5d1){const _0x30029d=_0x26d5d1 instanceof Error?_0x26d5d1['message']:String(_0x26d5d1),_0x30f160=_0x30029d['replace'](/x-access-token:[^@]+@/g,'x-access-token:***@');throw new Error(_0x4cd179(0x130)+_0x6cdc1f+':\x20'+_0x30f160);}}function cloneOrResetRepo(_0x115466,_0x33a1c8,_0x16d6bb,_0x513388,_0x18bc08){const _0x818150=a4_0x4121d2,_0x2b9a7a=_0x115466[_0x818150(0xd4)][_0x818150(0xf4)],_0x1442d8=_0x2b9a7a[_0x818150(0xff)]('/')[_0x818150(0xe5)]()??_0x2b9a7a,_0x51c836=getClonePath(_0x16d6bb,_0x1442d8);if(_0x33a1c8[_0x818150(0xdd)]<Date[_0x818150(0xad)]())throw new Error(_0x818150(0xce)+_0x115466['name']+_0x818150(0x114));const _0x11bae2=_0x513388[_0x818150(0xa7)][_0x818150(0x121)](_0x2ca96b=>_0x2ca96b[_0x818150(0x138)]===_0x115466[_0x818150(0xe0)]);if(_0x11bae2&&isValidClone(_0x11bae2[_0x818150(0x108)]))return resetCloneToCleanState(_0x11bae2[_0x818150(0x108)],_0x115466[_0x818150(0x11e)],_0x18bc08),_0x11bae2;return cloneRepo(_0x2b9a7a,_0x33a1c8[_0x818150(0xf5)],_0x51c836,_0x18bc08),installDependencies(_0x51c836,_0x18bc08),{'workspaceId':_0x115466[_0x818150(0xe0)],'repoFullName':_0x2b9a7a,'localPath':_0x51c836,'defaultBranch':_0x115466['defaultBranch'],'clonedAt':Date['now']()};}async function clonePolygraphRepositories(_0x48d567,_0xbe96cd,_0x444143){const _0x12e8d1=a4_0x4121d2,{sessionId:_0x5c7bef,workspaces:_0x45b58b,credentials:_0x30ef21}=_0x444143;try{await ensurePolygraphGitignore(_0x48d567);const _0x4dd053=getCloneRegistryPath(_0x48d567,_0x5c7bef);let _0x1b83d7=loadCloneRegistry(_0x4dd053);!_0x1b83d7&&(_0x1b83d7={'sessionId':_0x5c7bef,'createdAt':Date[_0x12e8d1(0xad)](),'clones':[]});const _0x425b90=[];for(const _0xe3e4ea of _0x45b58b){const _0x99872f=_0x30ef21['find'](_0x159e1a=>_0x159e1a[_0x12e8d1(0x138)]===_0xe3e4ea[_0x12e8d1(0xe0)]);if(!_0x99872f)throw new Error(_0x12e8d1(0xcb)+_0xe3e4ea[_0x12e8d1(0xaa)]+'\x20('+_0xe3e4ea['_id']+')');const _0x57fd1e=cloneOrResetRepo(_0xe3e4ea,_0x99872f,_0x5c7bef,_0x1b83d7,_0xbe96cd);_0x425b90[_0x12e8d1(0xe8)](_0x57fd1e);}return _0x1b83d7[_0x12e8d1(0xa7)]=_0x425b90,saveCloneRegistry(_0x4dd053,_0x1b83d7),{'success':!![],'sessionId':_0x5c7bef,'clones':_0x425b90};}catch(_0x361645){const _0x1e1cb9=_0x361645 instanceof Error?_0x361645['message']:String(_0x361645);return _0xbe96cd[_0x12e8d1(0x10e)](_0x12e8d1(0xc9)+_0x1e1cb9),{'success':![],'sessionId':_0x5c7bef,'clones':[],'error':_0x1e1cb9};}}var import_child_process2=require(a4_0x4121d2(0x113)),import_fs2=require('fs'),import_path2=require('path');function ensureSandboxSettings(_0x28f649){const _0x68444f=a4_0x4121d2,_0x30a138=(0x0,import_path2[_0x68444f(0x12d)])(_0x28f649,_0x68444f(0x10d));!(0x0,import_fs2[_0x68444f(0xa0)])(_0x30a138)&&(0x0,import_fs2[_0x68444f(0xee)])(_0x30a138,{'recursive':!![]});const _0x27f925=(0x0,import_path2[_0x68444f(0x12d)])(_0x30a138,_0x68444f(0x9a)),_0x3b3556={'sandbox':{'enabled':!![],'autoAllowBashIfSandboxed':!![],'allowUnsandboxedCommands':![]}};(0x0,import_fs2[_0x68444f(0x10a)])(_0x27f925,JSON['stringify'](_0x3b3556,null,0x2),_0x68444f(0xdc));}function a4_0x1127(_0x3dbc23,_0x6aecdc){const _0x11b450=a4_0x11b4();return a4_0x1127=function(_0x1127ea,_0x36a8a0){_0x1127ea=_0x1127ea-0x8d;let _0x530c69=_0x11b450[_0x1127ea];return _0x530c69;},a4_0x1127(_0x3dbc23,_0x6aecdc);}var ChildAgentManager=class{constructor(_0x21a4f2){const _0x2d426a=a4_0x4121d2;this[_0x2d426a(0xe6)]=_0x21a4f2;}[a4_0x4121d2(0x8d)]=new Map();[a4_0x4121d2(0x125)]=0x3;[a4_0x4121d2(0x13b)]=0x5*0x3c*0x3e8;async[a4_0x4121d2(0xe1)](_0x4dc76f,_0x3cdc9c,_0x247585,_0x57fd3d,_0x5cc90f){const _0x40703b=a4_0x4121d2;let _0xb1f57f=this['agents']['get'](_0x4dc76f);!_0xb1f57f&&(_0xb1f57f={'workspaceId':_0x4dc76f,'repoPath':_0x3cdc9c,'process':null,'status':_0x40703b(0x132),'hasExistingSession':![],'retryCount':0x0},this[_0x40703b(0x8d)][_0x40703b(0x109)](_0x4dc76f,_0xb1f57f));if(_0xb1f57f[_0x40703b(0x123)]>=this['maxRetries'])return{'status':'failed','output':'','error':_0x40703b(0xca)+this[_0x40703b(0x125)]+_0x40703b(0xd2)+_0x4dc76f};const _0x250310=_0x57fd3d?'Context:\x20'+_0x57fd3d+_0x40703b(0xbd)+_0x247585:_0x247585;ensureSandboxSettings(_0x3cdc9c);const _0xdac99a=[_0x40703b(0xd9),_0x40703b(0xea)];return _0xb1f57f[_0x40703b(0x119)]?(_0xdac99a[_0x40703b(0xbf)](_0x40703b(0x9d)),this[_0x40703b(0xe6)][_0x40703b(0x10e)](_0x40703b(0x133)+_0x4dc76f)):this[_0x40703b(0xe6)]['log']('Starting\x20new\x20session\x20for\x20workspace\x20'+_0x4dc76f),this[_0x40703b(0xe6)]['log'](_0x40703b(0x95)+_0x3cdc9c),this['logger'][_0x40703b(0x10e)](_0x40703b(0xb3)+_0x250310[_0x40703b(0xc0)](0x0,0xc8)+_0x40703b(0xfe)),new Promise(_0x14a68e=>{const _0x51134b=_0x40703b;_0xb1f57f['status']=_0x51134b(0x101);const _0xcea02a=(0x0,import_child_process2['spawn'])('claude',_0xdac99a,{'cwd':_0x3cdc9c,'env':{...process['env']}});_0xb1f57f[_0x51134b(0xf2)]=_0xcea02a;let _0x4adf94='',_0xae3787='';_0xcea02a[_0x51134b(0xcd)][_0x51134b(0xf3)](_0x250310),_0xcea02a[_0x51134b(0xcd)]['end'](),_0xcea02a['stdout']['on']('data',_0x3c5133=>{const _0x4b21e8=_0x51134b,_0x344fc9=_0x3c5133['toString']();_0x4adf94+=_0x344fc9,this[_0x4b21e8(0xe6)][_0x4b21e8(0x10e)]('['+_0x4dc76f+']\x20stdout:\x20'+_0x344fc9['substring'](0x0,0x64)+(_0x344fc9[_0x4b21e8(0x93)]>0x64?_0x4b21e8(0xfe):'')),_0x5cc90f==null?void 0x0:_0x5cc90f(_0x344fc9);}),_0xcea02a[_0x51134b(0x117)]['on'](_0x51134b(0x116),_0x323319=>{const _0x5739f4=_0x51134b,_0x55b691=_0x323319[_0x5739f4(0x120)]();_0xae3787+=_0x55b691,this[_0x5739f4(0xe6)][_0x5739f4(0x10e)]('['+_0x4dc76f+_0x5739f4(0xc7)+_0x55b691);});const _0x17b120=setTimeout(()=>{const _0x5b0ec1=_0x51134b;this['logger']['log']('['+_0x4dc76f+_0x5b0ec1(0x127)+this[_0x5b0ec1(0x13b)]+'ms'),_0xcea02a[_0x5b0ec1(0x9b)](),_0xb1f57f['status']=_0x5b0ec1(0xe9),_0xb1f57f[_0x5b0ec1(0xf2)]=null,_0xb1f57f[_0x5b0ec1(0x123)]++,_0x14a68e({'status':'failed','output':_0x4adf94,'error':_0x5b0ec1(0xf1)+this['taskTimeout']/0x3e8+_0x5b0ec1(0x11b)});},this[_0x51134b(0x13b)]);_0xcea02a['on'](_0x51134b(0xa9),_0x40282b=>{const _0xa62bc9=_0x51134b;clearTimeout(_0x17b120),_0xb1f57f[_0xa62bc9(0xf2)]=null,this[_0xa62bc9(0xe6)]['log']('['+_0x4dc76f+_0xa62bc9(0x124)+_0x40282b),_0x40282b===0x0?(_0xb1f57f[_0xa62bc9(0x119)]=!![],_0xb1f57f[_0xa62bc9(0xfa)]='completed',_0xb1f57f[_0xa62bc9(0x123)]=0x0,_0x14a68e({'status':_0xa62bc9(0xa6),'output':_0x4adf94})):(_0xb1f57f[_0xa62bc9(0xfa)]=_0xa62bc9(0xe9),_0xb1f57f['retryCount']++,_0x14a68e({'status':'failed','output':_0x4adf94,'error':_0xa62bc9(0xc3)+_0x40282b+(_0xae3787?'\x0astderr:\x20'+_0xae3787:'')}));}),_0xcea02a['on'](_0x51134b(0xe3),_0x122114=>{const _0x2ea809=_0x51134b;clearTimeout(_0x17b120),_0xb1f57f['process']=null,_0xb1f57f[_0x2ea809(0xfa)]=_0x2ea809(0xe9),_0xb1f57f[_0x2ea809(0x123)]++,this[_0x2ea809(0xe6)][_0x2ea809(0x10e)]('['+_0x4dc76f+_0x2ea809(0x96)+_0x122114[_0x2ea809(0x8e)]),_0x14a68e({'status':_0x2ea809(0xe9),'output':_0x4adf94,'error':_0x2ea809(0xbe)+_0x122114[_0x2ea809(0x8e)]});});});}['isHealthy'](_0x5c1c40){const _0x540eb2=a4_0x4121d2,_0x4f6e34=this[_0x540eb2(0x8d)]['get'](_0x5c1c40);if(!_0x4f6e34)return!![];return _0x4f6e34[_0x540eb2(0x123)]<this['maxRetries'];}[a4_0x4121d2(0xf6)](_0x1dcc23){const _0x5c6a12=a4_0x4121d2,_0x5cbf82=this[_0x5c6a12(0x8d)][_0x5c6a12(0x10f)](_0x1dcc23);return(_0x5cbf82==null?void 0x0:_0x5cbf82[_0x5c6a12(0xfa)])??null;}['kill'](_0x37c85b){const _0x352dfe=a4_0x4121d2,_0x55987a=this['agents'][_0x352dfe(0x10f)](_0x37c85b);(_0x55987a==null?void 0x0:_0x55987a[_0x352dfe(0xf2)])&&(this['logger'][_0x352dfe(0x10e)](_0x352dfe(0x111)+_0x37c85b),_0x55987a[_0x352dfe(0xf2)][_0x352dfe(0x9b)](),_0x55987a['process']=null,_0x55987a[_0x352dfe(0xfa)]=_0x352dfe(0xe9));}['killAll'](){const _0x254af6=a4_0x4121d2;this['logger']['log'](_0x254af6(0xf0));for(const [_0x228444]of this['agents']){this[_0x254af6(0x9b)](_0x228444);}}[a4_0x4121d2(0xae)](_0x468db4){const _0xb580e7=a4_0x4121d2,_0x1a3c58=this[_0xb580e7(0x8d)]['get'](_0x468db4);_0x1a3c58&&(_0x1a3c58[_0xb580e7(0x119)]=![],_0x1a3c58['retryCount']=0x0,_0x1a3c58[_0xb580e7(0xfa)]=_0xb580e7(0x132),this[_0xb580e7(0xe6)][_0xb580e7(0x10e)](_0xb580e7(0x103)+_0x468db4));}['activeCount'](){const _0x3281f3=a4_0x4121d2;let _0x2de18f=0x0;for(const _0x2da52d of this[_0x3281f3(0x8d)]['values']()){_0x2da52d['process']!==null&&_0x2de18f++;}return _0x2de18f;}};async function polygraphInit(_0x4811ce,_0x1ab8c4){const _0x3f10e7=a4_0x4121d2,{sessionId:_0x209d1f,nxCloudId:_0x10c66b,nxCloudUrl:_0x2d625b,authHeaders:_0x335f14,workspacePath:_0x269094}=_0x1ab8c4,_0xab15fd=await initPolygraphSession(_0x4811ce,{'sessionId':_0x209d1f,'nxCloudId':_0x10c66b,'nxCloudUrl':_0x2d625b,'authHeaders':_0x335f14});if(_0xab15fd[_0x3f10e7(0xe3)])return{'success':![],'error':_0x3f10e7(0x11c)+_0xab15fd['error'][_0x3f10e7(0x8e)]+_0x3f10e7(0xb8)+_0xab15fd['url']};const _0x25898e=_0xab15fd[_0x3f10e7(0x116)];if(!(_0x25898e==null?void 0x0:_0x25898e[_0x3f10e7(0xfb)])||_0x25898e[_0x3f10e7(0xfb)][_0x3f10e7(0x93)]===0x0)return{'success':!![],'sessionId':_0x209d1f,'clonesSummary':'Session\x20initialized\x20but\x20no\x20workspaces\x20returned.\x0aSession\x20ID:\x20'+_0x209d1f};const _0x9b4295=await clonePolygraphRepositories(_0x269094,_0x4811ce,_0x25898e);if(!_0x9b4295[_0x3f10e7(0x10c)])return{'success':![],'error':'Failed\x20to\x20clone\x20repositories:\x20'+_0x9b4295[_0x3f10e7(0xe3)]};const _0x273f88=_0x9b4295[_0x3f10e7(0xa7)][_0x3f10e7(0x118)](_0x18c4cf=>'-\x20'+_0x18c4cf[_0x3f10e7(0xe7)]+':\x20'+_0x18c4cf[_0x3f10e7(0x108)])[_0x3f10e7(0x12d)]('\x0a');return{'success':!![],'sessionId':_0x209d1f,'clonesSummary':'Session\x20initialized\x20successfully.\x0aSession\x20ID:\x20'+_0x209d1f+_0x3f10e7(0x129)+_0x273f88+_0x3f10e7(0xab)};}var childAgentManager;function getChildAgentManager(_0x1b70b5){const _0x3e8b3a=a4_0x4121d2;if(!childAgentManager){childAgentManager=new ChildAgentManager(_0x1b70b5);const _0x5a4b74=()=>childAgentManager[_0x3e8b3a(0xf7)]();process['on'](_0x3e8b3a(0x9f),_0x5a4b74),process['on'](_0x3e8b3a(0x102),_0x5a4b74),process['on'](_0x3e8b3a(0xd6),_0x5a4b74);}return childAgentManager;}async function polygraphDelegate(_0x57ce25,_0x2e7548){const _0x3d734c=a4_0x4121d2,_0x579e12=getChildAgentManager(_0x57ce25),{sessionId:_0x3b078f,target:_0x594037,instruction:_0x54a01d,context:_0x36013f,workspacePath:_0x4c2eb7}=_0x2e7548,_0x3faf65=getCloneRegistryPath(_0x4c2eb7,_0x3b078f),_0x2e17a6=loadCloneRegistry(_0x3faf65);if(!_0x2e17a6)return{'success':![],'error':'No\x20Polygraph\x20session\x20found\x20with\x20ID:\x20'+_0x3b078f+_0x3d734c(0xc2)};const _0x42422e=_0x2e17a6[_0x3d734c(0xa7)][_0x3d734c(0x121)](_0x5cdf8a=>_0x5cdf8a['workspaceId']===_0x594037||_0x5cdf8a['repoFullName']===_0x594037||_0x5cdf8a[_0x3d734c(0xe7)][_0x3d734c(0x97)]('/'+_0x594037));if(!_0x42422e){const _0x2a2c34=_0x2e17a6['clones'][_0x3d734c(0x118)](_0x384ca9=>{const _0x19fd2b=_0x3d734c,_0x222983=_0x384ca9['repoFullName']['split']('/')['pop']()??_0x384ca9['repoFullName'];return _0x222983+'\x20('+_0x384ca9[_0x19fd2b(0xe7)]+')';})['join'](',\x20');return{'success':![],'error':_0x3d734c(0x122)+_0x594037+_0x3d734c(0x104)+_0x3b078f+_0x3d734c(0x92)+_0x2a2c34};}_0x57ce25['log'](_0x3d734c(0xa2)+_0x42422e[_0x3d734c(0xe7)]+_0x3d734c(0xc6)+_0x42422e[_0x3d734c(0x108)]);const _0x282b1c=await _0x579e12[_0x3d734c(0xe1)](_0x42422e['workspaceId'],_0x42422e[_0x3d734c(0x108)],_0x54a01d,_0x36013f);return _0x282b1c[_0x3d734c(0xfa)]==='completed'?{'success':!![],'output':_0x282b1c[_0x3d734c(0xe2)]}:{'success':![],'error':_0x3d734c(0xcf)+_0x282b1c[_0x3d734c(0xe3)]+'\x0a\x0aPartial\x20output:\x0a'+_0x282b1c['output']};}0x0&&(module['exports']={'polygraphDelegate':polygraphDelegate,'polygraphInit':polygraphInit});function a4_0x11b4(){const _0xddf845=['stdin','Credential\x20for\x20workspace\x20','Task\x20failed:\x20','__esModule','Invalid\x20branch\x20name:\x20',')\x20exceeded\x20for\x20workspace\x20','replace','vcsConfiguration','dirname','SIGTERM','Resetting\x20clone\x20at\x20','git\x20checkout\x20','--print','nxCloudId','42GBlnFX','utf-8','expiresAt','git\x20clone\x20','Dependencies\x20installed\x20successfully','_id','executeTask','output','error','git\x20pull\x20origin\x20','pop','logger','repoFullName','push','failed','--dangerously-skip-permissions','Polygraph\x20init-session\x20response:\x20','6UpVUxv','signal','mkdirSync','.gitignore','Killing\x20all\x20child\x20agent\x20processes','Task\x20timed\x20out\x20after\x20','process','write','repositoryFullName','token','getStatus','killAll','path','Making\x20polygraph\x20init-session\x20request\x20to:\x20','status','workspaces','2232520wbRWzs','3987951gFWlcg','...','split','.nx/','running','SIGINT','Reset\x20session\x20state\x20for\x20workspace\x20','\x22\x20not\x20found\x20in\x20session\x20','Installing\x20dependencies\x20with\x20','.git','git\x20reset\x20--hard','localPath','set','writeFileSync','bun.lockb','success','.claude','log','get','getOwnPropertyDescriptor','Killing\x20process\x20for\x20workspace\x20','Failed\x20to\x20reset\x20clone\x20at\x20','child_process','\x20has\x20expired','authentication','data','stderr','map','hasExistingSession','10875069ilEHnx','\x20seconds','Failed\x20to\x20initialize\x20Polygraph\x20session:\x20','114286TlovCS','defaultBranch','git\x20rev-parse\x20--git-dir','toString','find','Repository\x20\x22','retryCount',']\x20Claude\x20exited\x20with\x20code\x20','maxRetries','1788918uxJGmQ',']\x20Task\x20timed\x20out\x20after\x20','trim','\x0a\x0aCloned\x20repositories:\x0a','readFileSync','pnpm-lock.yaml','network','join','other','getOwnPropertyNames','Failed\x20to\x20clone\x20','\x20to\x20','pending','Using\x20--continue\x20for\x20workspace\x20','env','enumerable','parse','prototype','workspaceId','application/json','3640428SDZoJd','taskTimeout','Authentication\x20error:\x20','pipe','agents','message','.nx/\x0a','10ChHfnZ','tmpdir','.\x0aAvailable\x20repositories:\x20','length','Cloning\x20','Executing\x20task\x20in\x20',']\x20Spawn\x20error:\x20','endsWith','npm','hasOwnProperty','settings.json','kill','abort','--continue','stringify','exit','existsSync','@github.com/','Delegating\x20task\x20to\x20','.nx','\x20in\x20','execSync','completed','clones','text','close','name','\x0a\x0aUse\x20cloud_polygraph_coordinate\x20to\x20execute\x20tasks\x20across\x20these\x20repositories.','debug','now','resetSession','10lbPVCF','80968BYxaQU','pnpm','call','Prompt:\x20','polygraph','10qvCyIV','yarn','object','\x0aURL:\x20','authHeaders','\x0a.nx/\x0a','workspace.json','/nx-cloud/polygraph/init-session','\x0a\x0aTask:\x20','Failed\x20to\x20spawn\x20Claude:\x20','unshift','substring','Request\x20headers:\x20','.\x20Run\x20cloud_polygraph_init\x20first.','Claude\x20exited\x20with\x20code\x20','some','Failed\x20to\x20install\x20dependencies\x20with\x20','\x20at\x20',']\x20stderr:\x20','POST','Failed\x20to\x20clone\x20repositories:\x20','Max\x20retries\x20(','No\x20credential\x20found\x20for\x20workspace\x20','exports'];a4_0x11b4=function(){return _0xddf845;};return a4_0x11b4();}