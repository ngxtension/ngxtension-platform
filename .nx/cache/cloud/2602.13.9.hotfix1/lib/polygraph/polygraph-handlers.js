'use strict';const a4_0x20a9ce=a4_0xa298;(function(_0x4f9b67,_0x2dd692){const _0xe382d9=a4_0xa298,_0x346ede=_0x4f9b67();while(!![]){try{const _0x421df0=parseInt(_0xe382d9(0x261))/0x1*(-parseInt(_0xe382d9(0x19b))/0x2)+-parseInt(_0xe382d9(0x1ed))/0x3+parseInt(_0xe382d9(0x20c))/0x4*(-parseInt(_0xe382d9(0x2b5))/0x5)+-parseInt(_0xe382d9(0x223))/0x6*(parseInt(_0xe382d9(0x2ba))/0x7)+parseInt(_0xe382d9(0x19a))/0x8+-parseInt(_0xe382d9(0x29b))/0x9*(-parseInt(_0xe382d9(0x1ab))/0xa)+parseInt(_0xe382d9(0x262))/0xb;if(_0x421df0===_0x2dd692)break;else _0x346ede['push'](_0x346ede['shift']());}catch(_0x76e504){_0x346ede['push'](_0x346ede['shift']());}}}(a4_0x9faf,0xafec5));function a4_0xa298(_0x146926,_0x5bc20d){const _0x9fafb5=a4_0x9faf();return a4_0xa298=function(_0xa298b3,_0x177619){_0xa298b3=_0xa298b3-0x18f;let _0x174c9e=_0x9fafb5[_0xa298b3];return _0x174c9e;},a4_0xa298(_0x146926,_0x5bc20d);}var __defProp=Object[a4_0x20a9ce(0x2b4)],__getOwnPropDesc=Object['getOwnPropertyDescriptor'],__getOwnPropNames=Object[a4_0x20a9ce(0x2a8)],__hasOwnProp=Object[a4_0x20a9ce(0x267)][a4_0x20a9ce(0x1d5)],__export=(_0x450f37,_0x2b258b)=>{for(var _0x258268 in _0x2b258b)__defProp(_0x450f37,_0x258268,{'get':_0x2b258b[_0x258268],'enumerable':!![]});},__copyProps=(_0xeec176,_0x56b96d,_0x30c459,_0x5db628)=>{const _0x12fce8=a4_0x20a9ce;if(_0x56b96d&&typeof _0x56b96d===_0x12fce8(0x1c8)||typeof _0x56b96d===_0x12fce8(0x190)){for(let _0x55b0bd of __getOwnPropNames(_0x56b96d))if(!__hasOwnProp[_0x12fce8(0x258)](_0xeec176,_0x55b0bd)&&_0x55b0bd!==_0x30c459)__defProp(_0xeec176,_0x55b0bd,{'get':()=>_0x56b96d[_0x55b0bd],'enumerable':!(_0x5db628=__getOwnPropDesc(_0x56b96d,_0x55b0bd))||_0x5db628[_0x12fce8(0x1ef)]});}return _0xeec176;},__toCommonJS=_0xa8ce24=>__copyProps(__defProp({},a4_0x20a9ce(0x1c7),{'value':!![]}),_0xa8ce24),polygraph_handlers_exports={};__export(polygraph_handlers_exports,{'formatPolygraphSession':()=>formatPolygraphSession,'polygraphAssociatePR':()=>polygraphAssociatePR,'polygraphChildStatus':()=>polygraphChildStatus,'polygraphCreatePRs':()=>polygraphCreatePRs,'polygraphDelegate':()=>polygraphDelegate,'polygraphGetSession':()=>polygraphGetSession,'polygraphInit':()=>polygraphInit,'polygraphMarkReady':()=>polygraphMarkReady,'polygraphPushBranch':()=>polygraphPushBranch,'polygraphStopChild':()=>polygraphStopChild}),module[a4_0x20a9ce(0x251)]=__toCommonJS(polygraph_handlers_exports);var POLYGRAPH_FETCH_TIMEOUT_MS=0x186a0;function sanitizeError(_0x510ee5){const _0x5ad23a=a4_0x20a9ce;return _0x510ee5['replace'](/x-access-token:[^@]+@/g,_0x5ad23a(0x297));}function a4_0x9faf(){const _0x39bbc8=['path','remote','npm','origin','pull','pending','getOwnPropertyNames','\x20->\x20','Failed\x20to\x20get\x20remote\x20URL:\x20',']\x20Task\x20timed\x20out\x20after\x20','\x20to\x20','getChildrenStatus','Making\x20polygraph\x20init-session\x20request\x20to:\x20','clones','--output-format','stopped','prs','plan','defineProperty','5fKZeYe',']\x20Claude\x20exited\x20with\x20code\x20','main','bun','Associating\x20PR\x20with\x20session:\x20','1959587ZfxfJZ','claude','nodes','agent-output.log','now','results','Retrieved\x20credential\x20for\x20workspace\x20','polygraphSessionUrl','\x0a\x0aTask:\x20','parse','URL:\x20','\x20already\x20exists,\x20resetting\x20to\x20clean\x20state','log','A\x20task\x20is\x20already\x20running\x20for\x20workspace\x20','Session\x20ID','.git','Prompt:\x20','Failed\x20to\x20get\x20remote\x20origin\x20URL:\x20','Failed\x20to\x20install\x20dependencies\x20with\x20','SIGINT','\x20contains\x20invalid\x20git\x20ref\x20pattern','function','[stderr]\x20','logger','close','Failed\x20to\x20associate\x20PR:\x20','nx-mcp@latest','message','length','started','/prs/associate','3572200aogwwU','1136112txjjoE','values','Failed\x20to\x20initialize\x20Polygraph\x20session:\x20','ciStatus','startTask','repoFullName','edges','cipeUrl','expiresAt','Pushing\x20','Warning:\x20failed\x20to\x20save\x20session\x20plan:\x20','--dangerously-skip-permissions','exit','Delegating\x20task\x20to\x20','Credential\x20for\x20workspace\x20','Error:\x20','10WXkxAW','set','\x20workspace(s)\x20and\x20','\x20\x20CI:\x20No\x20pipeline\x20execution\x20found','toLowerCase','running','existsSync','substring','startedAt','dirname','git','Found\x20repo\x20for\x20','Network\x20error:\x20','pipe','\x0a\x0aCloned\x20repositories:\x0a','\x20to\x20origin','/plan','instruction','\x0a.nx/polygraph/\x0a','Resetting\x20clone\x20at\x20','Remote\x20origin\x20URL\x20does\x20not\x20match\x20expected\x20repo\x20','git\x20remote\x20get-url\x20origin','currentInstruction','baseBranch','taskTimeout','npx','@github.com/','repoPath','__esModule','object','agentSessionId','maxRetries','.nx/polygraph/\x0a','initiator','slice','child_process','PR\x20creation\x20request\x20failed:\x20','/prs/create','number','trim','url','prNumber','hasOwnProperty','/prs/mark-ready','Fetching\x20session\x20credentials\x20from:\x20','mkdirSync','logFile','https://x-access-token:','\x22\x20at\x20','\x20PR(s)\x20ready','authHeaders','.nx','.\x20Use\x20stop_child\x20first.','prUrls','\x20\x20Branch:\x20','Dependency\x20Graph:','\x20\x20CI:\x20','yarn.lock','\x0a\x0aUse\x20cloud_polygraph_delegate\x20to\x20execute\x20tasks\x20across\x20these\x20repositories.','--continue','join','Retrieved\x20session\x20with\x20','\x20at\x20','Failed\x20to\x20mark\x20PRs\x20ready:\x20','.gitignore','split','2081580IZyQIE','Context:\x20','enumerable','map','Failed\x20to\x20fetch\x20session:\x20','Retrieved\x20','--print','PR\x20creation\x20endpoint\x20returned\x20','.\x20Session\x20preserved\x20for\x20--continue.','origin/','endsWith','end','..HEAD','validation','Stopping\x20child\x20agent\x20for\x20','Request\x20body:\x20','--count','execFileSync','stdin','\x22\x20not\x20found\x20in\x20session\x20','Authentication\x20error:\x20','Session\x20initialized\x20successfully.\x0aSession\x20ID:\x20','Repository\x20','Push\x20failed:\x20','token','\x20\x20URL:\x20','--depth','nrwl/nx-ai-agents-config','.nx/polygraph/','No\x20Polygraph\x20session\x20found\x20with\x20ID:\x20','status','5416408kEPCfS','killAll','Failed\x20to\x20clone\x20repositories:\x20','localPath','Failed\x20to\x20call\x20mark\x20ready\x20endpoint:\x20','title','defaultBranch','write','error','Mark\x20ready\x20endpoint\x20returned\x20','pop','readFileSync','retryCount','stringify','nxCloudUrl','workspacePath','git\x20rev-parse\x20--abbrev-ref\x20origin/HEAD','debug','SIGTERM','output','data','Failed\x20to\x20get\x20credentials:\x20','network','6tHmKZy','\x20not\x20found\x20in\x20session','dependencyGraph','source','/nx-cloud/polygraph/session/','Unable\x20to\x20parse\x20remote\x20origin\x20URL:\x20','test','PR\x20created\x20successfully:\x20','repos','github','spawn','bun.lockb','Request\x20headers:\x20','\x20commit(s)\x20ahead\x20of\x20','\x0aURL:\x20','ignore','name','get','Stopped\x20child\x20agent\x20for\x20','prUrl','Associated\x20PR\x20with\x20session\x20','credentials','-fd','repo','clone','text','Pull\x20Requests:','--system-prompt','\x20PR(s)','POST','owner','filter','includes','\x20install','HEAD:refs/heads/','--hard','activeCount','settings.local.json','kill','writeFileSync','signal','pullRequests','branch','polygraph','some','agents','exports','allSucceeded','Session:\x20','PR\x20creation\x20failed:\x20','success','\x20\x20CIPE:\x20','stream-json','call','stdout','draft','application/json','failed','abort','clear','Failed\x20to\x20call\x20credentials\x20endpoint:\x20','Get\x20session\x20endpoint\x20returned\x20','1iEgztS','33541706ywbmBy','process','Failed\x20to\x20fetch\x20credentials:\x20','Cloning\x20','sessionId','prototype','reset','--experimental-polygraph','No\x20credential\x20found\x20for\x20workspace\x20','/credentials','Git\x20push\x20failed:\x20','Killing\x20all\x20child\x20agent\x20processes','completed','push','Credentials\x20endpoint\x20returned\x20','headBranch','getChildOutput','.\x20Use\x20cloud_polygraph_child_status\x20to\x20monitor\x20progress.','Branch\x20name','https://x-access-token:@github.com/','Creating\x20PR\x20via\x20nx-api:\x20','Remote\x20origin\x20URL:\x20','--verbose','\x22\x20in\x20session\x20','Fetching\x20session\x20from:\x20','No\x20active\x20child\x20agent\x20found\x20for\x20workspace\x20','Failed\x20to\x20check\x20commits\x20ahead:\x20','execSync','pnpm','Repository\x20\x22','match','.\x20Run\x20cloud_polygraph_init\x20first.','Installing\x20dependencies\x20with\x20','.\x0aAvailable\x20repositories:\x20','checkout','No\x20commits\x20ahead\x20of\x20base\x20branch','createWriteStream','git\x20rev-parse\x20--git-dir','Session\x20initialized\x20but\x20no\x20workspaces\x20returned.\x0aSession\x20ID:\x20','env','.nx/polygraph','Polygraph\x20init-session\x20response:\x20','session.json','Workspaces:','target','workspaces','Task\x20started\x20for\x20','stopChild','find','\x20credential(s)','GET','toString','...','x-access-token:***@','utf-8','workspaceId','stdio','1086921RzcVew','repositoryFullName',')\x20exceeded\x20for\x20workspace\x20','#\x20Polygraph\x20Child\x20Agent\x0a\x0aYou\x20are\x20operating\x20as\x20a\x20child\x20agent\x20in\x20a\x20Polygraph\x20multi-repository\x20coordination\x20session.\x0a\x0a##\x20Guidelines\x0a\x0a-\x20Focus\x20on\x20the\x20specific\x20task\x20delegated\x20to\x20you\x20by\x20the\x20parent\x20agent\x0a-\x20Make\x20changes\x20only\x20within\x20this\x20repository\x0a-\x20Provide\x20clear,\x20concise\x20status\x20updates\x20about\x20your\x20progress\x0a-\x20If\x20you\x20encounter\x20blocking\x20issues,\x20report\x20them\x20clearly\x20so\x20the\x20parent\x20agent\x20can\x20assist\x0a\x0a##\x20Context\x0a\x0aThis\x20skill\x20is\x20automatically\x20injected\x20when\x20this\x20repository\x20is\x20being\x20coordinated\x20as\x20part\x20of\x20a\x20larger\x20Polygraph\x20session.\x20The\x20parent\x20agent\x20will\x20provide\x20specific\x20instructions\x20for\x20the\x20task\x20at\x20hand.\x0a','Checking\x20commits\x20ahead\x20of\x20','Directory\x20','rev-list'];a4_0x9faf=function(){return _0x39bbc8;};return a4_0x9faf();}function validateGitRef(_0x5e05d7,_0x77a186){const _0xc64c=a4_0x20a9ce;if(!_0x5e05d7||_0x5e05d7[_0xc64c(0x1d2)]()[_0xc64c(0x197)]===0x0)return _0x77a186+'\x20must\x20not\x20be\x20empty';if(/[;&|`$(){}[\]!#~<>\\'"\s\x00-\x1f\x7f]/[_0xc64c(0x229)](_0x5e05d7))return _0x77a186+'\x20contains\x20invalid\x20characters';if(_0x5e05d7[_0xc64c(0x243)]('..')||_0x5e05d7['startsWith']('-')||_0x5e05d7['startsWith']('.'))return _0x77a186+_0xc64c(0x18f);return null;}async function associatePolygraphPR(_0x1fcee6,_0x46a360){const _0x3a0b6d=a4_0x20a9ce,_0x413f83=_0x46a360[_0x3a0b6d(0x21a)]+_0x3a0b6d(0x227)+encodeURIComponent(_0x46a360[_0x3a0b6d(0x266)])+_0x3a0b6d(0x199),_0x447961={'Content-Type':_0x3a0b6d(0x25b),..._0x46a360['authHeaders']};_0x1fcee6['log'](_0x3a0b6d(0x2b9)+_0x413f83);try{const _0x4321c2=new AbortController(),_0x5a0f8e=setTimeout(()=>_0x4321c2[_0x3a0b6d(0x25d)](),POLYGRAPH_FETCH_TIMEOUT_MS),_0x1539e1=await fetch(_0x413f83,{'method':'POST','headers':_0x447961,'body':JSON[_0x3a0b6d(0x219)]({..._0x46a360[_0x3a0b6d(0x236)]?{'prUrl':_0x46a360['prUrl']}:{},..._0x46a360['branch']?{'branch':_0x46a360[_0x3a0b6d(0x24d)]}:{}}),'signal':_0x4321c2['signal']});clearTimeout(_0x5a0f8e);const _0x6bcfa5=await _0x1539e1[_0x3a0b6d(0x23c)]();if(!_0x1539e1['ok'])return _0x1fcee6['log'](_0x3a0b6d(0x194)+_0x1539e1[_0x3a0b6d(0x20b)]+'\x20'+_0x6bcfa5),{'success':![],'error':'Associate\x20PR\x20endpoint\x20returned\x20'+_0x1539e1[_0x3a0b6d(0x20b)]+':\x20'+_0x6bcfa5};const _0x5e809e=JSON[_0x3a0b6d(0x2c3)](_0x6bcfa5);return _0x1fcee6[_0x3a0b6d(0x2c6)](_0x3a0b6d(0x237)+_0x5e809e['sessionId']),{'success':!![],'sessionId':_0x5e809e[_0x3a0b6d(0x266)],'prs':_0x5e809e[_0x3a0b6d(0x2b2)]};}catch(_0x158203){const _0x5f3f19=_0x158203 instanceof Error?_0x158203[_0x3a0b6d(0x196)]:String(_0x158203);return _0x1fcee6[_0x3a0b6d(0x2c6)](_0x3a0b6d(0x194)+_0x5f3f19),{'success':![],'error':'Failed\x20to\x20call\x20associate\x20PR\x20endpoint:\x20'+_0x5f3f19};}}async function createPolygraphPR(_0x46cf42,_0x5df59d){const _0x4a4bbc=a4_0x20a9ce;var _0x487631;const _0x101850=_0x5df59d[_0x4a4bbc(0x21a)]+_0x4a4bbc(0x227)+encodeURIComponent(_0x5df59d[_0x4a4bbc(0x266)])+_0x4a4bbc(0x1d0),_0xcd8351={'Content-Type':_0x4a4bbc(0x25b),..._0x5df59d[_0x4a4bbc(0x1dd)]},_0x4cdc43=JSON[_0x4a4bbc(0x219)]({'title':_0x5df59d[_0x4a4bbc(0x211)],'body':_0x5df59d['body']||null,'headBranch':_0x5df59d[_0x4a4bbc(0x271)],'baseBranch':_0x5df59d[_0x4a4bbc(0x1c2)]||null,'draft':_0x5df59d[_0x4a4bbc(0x25a)]??!![],'workspaceId':_0x5df59d[_0x4a4bbc(0x299)]});_0x46cf42[_0x4a4bbc(0x2c6)](_0x4a4bbc(0x276)+_0x101850),(_0x487631=_0x46cf42['debug'])==null?void 0x0:_0x487631[_0x4a4bbc(0x258)](_0x46cf42,_0x4a4bbc(0x1fc)+_0x4cdc43);try{const _0x15b7ca=new AbortController(),_0x1ee7a2=setTimeout(()=>_0x15b7ca['abort'](),POLYGRAPH_FETCH_TIMEOUT_MS),_0x582ba9=await fetch(_0x101850,{'method':_0x4a4bbc(0x240),'headers':_0xcd8351,'body':_0x4cdc43,'signal':_0x15b7ca[_0x4a4bbc(0x24b)]});clearTimeout(_0x1ee7a2);const _0x1ce1db=await _0x582ba9[_0x4a4bbc(0x23c)]();if(!_0x582ba9['ok'])return _0x46cf42[_0x4a4bbc(0x2c6)](_0x4a4bbc(0x254)+_0x582ba9['status']+'\x20'+_0x1ce1db),{'success':![],'error':_0x4a4bbc(0x1f4)+_0x582ba9['status']+':\x20'+_0x1ce1db};const _0x5b4067=JSON[_0x4a4bbc(0x2c3)](_0x1ce1db);return _0x46cf42['log'](_0x4a4bbc(0x22a)+_0x5b4067[_0x4a4bbc(0x1d3)]),{'success':!![],..._0x5b4067};}catch(_0x274d8a){const _0x39d278=_0x274d8a instanceof Error?_0x274d8a['message']:String(_0x274d8a);return _0x46cf42[_0x4a4bbc(0x2c6)](_0x4a4bbc(0x1cf)+_0x39d278),{'success':![],'error':'Failed\x20to\x20call\x20PR\x20creation\x20endpoint:\x20'+_0x39d278};}}async function getPolygraphSession(_0x29efdf,_0x4aa6e8){const _0x55c924=a4_0x20a9ce;var _0x45d6c5,_0x49a441;const _0x52a5b1=_0x4aa6e8[_0x55c924(0x21a)]+_0x55c924(0x227)+encodeURIComponent(_0x4aa6e8[_0x55c924(0x266)]),_0x4ec571={'Content-Type':_0x55c924(0x25b),..._0x4aa6e8['authHeaders']};_0x29efdf[_0x55c924(0x2c6)](_0x55c924(0x27a)+_0x52a5b1);try{const _0x50f64a=new AbortController(),_0x4bbf43=setTimeout(()=>_0x50f64a[_0x55c924(0x25d)](),POLYGRAPH_FETCH_TIMEOUT_MS),_0x2b6f87=await fetch(_0x52a5b1,{'method':_0x55c924(0x294),'headers':_0x4ec571,'signal':_0x50f64a[_0x55c924(0x24b)]});clearTimeout(_0x4bbf43);const _0x14f950=await _0x2b6f87[_0x55c924(0x23c)]();if(!_0x2b6f87['ok'])return _0x29efdf['log'](_0x55c924(0x1f1)+_0x2b6f87[_0x55c924(0x20b)]+'\x20'+_0x14f950),{'success':![],'error':_0x55c924(0x260)+_0x2b6f87['status']+':\x20'+_0x14f950};const _0x15a3c3=JSON[_0x55c924(0x2c3)](_0x14f950);return _0x29efdf[_0x55c924(0x2c6)](_0x55c924(0x1e8)+(((_0x45d6c5=_0x15a3c3[_0x55c924(0x28f)])==null?void 0x0:_0x45d6c5[_0x55c924(0x197)])??0x0)+_0x55c924(0x1ad)+(((_0x49a441=_0x15a3c3[_0x55c924(0x24c)])==null?void 0x0:_0x49a441[_0x55c924(0x197)])??0x0)+_0x55c924(0x23f)),{'success':!![],'session':_0x15a3c3};}catch(_0x11d67a){const _0x2fbdb8=_0x11d67a instanceof Error?_0x11d67a[_0x55c924(0x196)]:String(_0x11d67a);return _0x29efdf['log'](_0x55c924(0x1f1)+_0x2fbdb8),{'success':![],'error':'Failed\x20to\x20call\x20get\x20session\x20endpoint:\x20'+_0x2fbdb8};}}var import_child_process=require(a4_0x20a9ce(0x1ce)),import_fs=require('fs'),import_os=require('os'),import_path=require(a4_0x20a9ce(0x2a2));async function initPolygraphSession(_0x583253,_0x1b9b2f){const _0x15b5ba=a4_0x20a9ce;var _0x548c45;const _0x52031f=_0x1b9b2f[_0x15b5ba(0x21a)]+'/nx-cloud/polygraph/init-session',_0x50570b={'Content-Type':_0x15b5ba(0x25b),..._0x1b9b2f['authHeaders']},_0x13d9e9=JSON[_0x15b5ba(0x219)]({'sessionId':_0x1b9b2f[_0x15b5ba(0x266)],'workspaceId':_0x1b9b2f['nxCloudId']});_0x583253[_0x15b5ba(0x2c6)](_0x15b5ba(0x2ae)+_0x52031f),_0x583253[_0x15b5ba(0x2c6)](_0x15b5ba(0x22f)+JSON[_0x15b5ba(0x219)](_0x50570b,null,0x2)),_0x583253[_0x15b5ba(0x2c6)](_0x15b5ba(0x1fc)+_0x13d9e9);try{const _0xd1a779=new AbortController(),_0x43df72=setTimeout(()=>_0xd1a779[_0x15b5ba(0x25d)](),POLYGRAPH_FETCH_TIMEOUT_MS),_0x3ff3fd=await fetch(_0x52031f,{'method':_0x15b5ba(0x240),'headers':_0x50570b,'body':_0x13d9e9,'signal':_0xd1a779[_0x15b5ba(0x24b)]});clearTimeout(_0x43df72);const _0x569567=await _0x3ff3fd['text']();if(!_0x3ff3fd['ok']){if(_0x3ff3fd[_0x15b5ba(0x20b)]===0x191)return _0x583253['log'](_0x15b5ba(0x201)+_0x569567),{'url':_0x52031f,'error':{'type':'authentication','message':_0x569567}};return _0x583253[_0x15b5ba(0x2c6)](_0x15b5ba(0x1aa)+_0x3ff3fd[_0x15b5ba(0x20b)]+'\x20'+_0x569567),{'url':_0x52031f,'error':{'type':'other','message':_0x569567}};}const _0x3dfe8a=JSON['parse'](_0x569567);return(_0x548c45=_0x583253[_0x15b5ba(0x21d)])==null?void 0x0:_0x548c45['call'](_0x583253,_0x15b5ba(0x28b)+JSON[_0x15b5ba(0x219)](_0x3dfe8a)),{'url':_0x52031f,'data':_0x3dfe8a};}catch(_0x5111cf){const _0x71dcfd=_0x5111cf instanceof Error?_0x5111cf['message']:String(_0x5111cf);return _0x583253[_0x15b5ba(0x2c6)](_0x15b5ba(0x1b7)+_0x71dcfd),{'url':_0x52031f,'error':{'type':_0x15b5ba(0x222),'message':_0x71dcfd}};}}function getRegistryPath(_0x4d8a1a,_0x1c798d){const _0x171110=a4_0x20a9ce;return(0x0,import_path[_0x171110(0x1e7)])(_0x4d8a1a,_0x171110(0x1de),_0x171110(0x24e),_0x1c798d,_0x171110(0x28c));}async function ensurePolygraphGitignore(_0x3779a7){const _0x4aa8a5=a4_0x20a9ce,_0x480bc6=(0x0,import_path[_0x4aa8a5(0x1e7)])(_0x3779a7,_0x4aa8a5(0x1eb));if(!(0x0,import_fs[_0x4aa8a5(0x1b1)])(_0x480bc6))return;const _0xdf36ca=(0x0,import_fs[_0x4aa8a5(0x217)])(_0x480bc6,_0x4aa8a5(0x298)),_0x57eb2c=_0xdf36ca[_0x4aa8a5(0x1ec)]('\x0a');if(_0x57eb2c[_0x4aa8a5(0x24f)](_0x42d87d=>_0x42d87d[_0x4aa8a5(0x1d2)]()===_0x4aa8a5(0x28a)||_0x42d87d['trim']()===_0x4aa8a5(0x209)))return;const _0x4625b7=_0xdf36ca[_0x4aa8a5(0x1f7)]('\x0a')?_0xdf36ca+_0x4aa8a5(0x1cb):_0xdf36ca+_0x4aa8a5(0x1bd);(0x0,import_fs['writeFileSync'])(_0x480bc6,_0x4625b7,'utf-8');}function loadRepoRegistry(_0x30efab){const _0x5dd9c3=a4_0x20a9ce;if(!(0x0,import_fs['existsSync'])(_0x30efab))return null;try{const _0x24b15a=(0x0,import_fs[_0x5dd9c3(0x217)])(_0x30efab,'utf-8');return JSON['parse'](_0x24b15a);}catch{return null;}}function saveRepoRegistry(_0x13c8f5,_0x5bdf37){const _0x890b6=a4_0x20a9ce,_0x543024=(0x0,import_path['dirname'])(_0x13c8f5);!(0x0,import_fs[_0x890b6(0x1b1)])(_0x543024)&&(0x0,import_fs['mkdirSync'])(_0x543024,{'recursive':!![]}),(0x0,import_fs[_0x890b6(0x24a)])(_0x13c8f5,JSON[_0x890b6(0x219)](_0x5bdf37,null,0x2),_0x890b6(0x298));}function getClonePath(_0x2e503e,_0x2d22b9){const _0x40db81=a4_0x20a9ce;return(0x0,import_path[_0x40db81(0x1e7)])((0x0,import_fs['realpathSync'])((0x0,import_os['tmpdir'])()),_0x40db81(0x24e),_0x2e503e,_0x2d22b9);}function isValidClone(_0x174acb){const _0x1a3809=a4_0x20a9ce;if(!(0x0,import_fs[_0x1a3809(0x1b1)])(_0x174acb))return![];try{return(0x0,import_child_process[_0x1a3809(0x27d)])(_0x1a3809(0x287),{'cwd':_0x174acb,'stdio':_0x1a3809(0x1b8)}),!![];}catch{return![];}}function detectPackageManager(_0x417814){const _0x5b2339=a4_0x20a9ce;if((0x0,import_fs[_0x5b2339(0x1b1)])((0x0,import_path[_0x5b2339(0x1e7)])(_0x417814,'pnpm-lock.yaml')))return _0x5b2339(0x27e);if((0x0,import_fs[_0x5b2339(0x1b1)])((0x0,import_path[_0x5b2339(0x1e7)])(_0x417814,_0x5b2339(0x1e4))))return'yarn';if((0x0,import_fs[_0x5b2339(0x1b1)])((0x0,import_path[_0x5b2339(0x1e7)])(_0x417814,_0x5b2339(0x22e))))return _0x5b2339(0x2b8);return _0x5b2339(0x2a4);}function installDependencies(_0x44ec16,_0x33dbad){const _0xb3bf6a=a4_0x20a9ce,_0x353cf9=detectPackageManager(_0x44ec16),_0x11d54e=_0x353cf9===_0xb3bf6a(0x2a4)?'npm\x20install':_0x353cf9+_0xb3bf6a(0x244);_0x33dbad[_0xb3bf6a(0x2c6)](_0xb3bf6a(0x282)+_0x353cf9+'\x20in\x20'+_0x44ec16);try{(0x0,import_child_process['execSync'])(_0x11d54e,{'cwd':_0x44ec16,'stdio':_0xb3bf6a(0x232),'env':{...process[_0xb3bf6a(0x289)]}}),_0x33dbad[_0xb3bf6a(0x2c6)]('Dependencies\x20installed\x20successfully');}catch(_0xff7d41){const _0x5957eb=_0xff7d41 instanceof Error?_0xff7d41['message']:String(_0xff7d41);throw new Error(_0xb3bf6a(0x2cc)+_0x353cf9+':\x20'+_0x5957eb);}}function resetCloneToCleanState(_0x4da251,_0x5075da,_0x485537){const _0x14666e=a4_0x20a9ce;_0x485537['log'](_0x14666e(0x1be)+_0x4da251+_0x14666e(0x2ac)+_0x5075da);const _0x542d44={...process[_0x14666e(0x289)],'GIT_TERMINAL_PROMPT':'0'},_0x10b202=validateGitRef(_0x5075da,_0x14666e(0x274));if(_0x10b202)throw new Error(_0x10b202);try{(0x0,import_child_process[_0x14666e(0x1fe)])(_0x14666e(0x1b5),['checkout',_0x5075da],{'cwd':_0x4da251,'stdio':_0x14666e(0x1b8),'env':_0x542d44}),(0x0,import_child_process[_0x14666e(0x1fe)])(_0x14666e(0x1b5),['reset',_0x14666e(0x246)],{'cwd':_0x4da251,'stdio':_0x14666e(0x1b8),'env':_0x542d44}),(0x0,import_child_process[_0x14666e(0x1fe)])(_0x14666e(0x1b5),['clean',_0x14666e(0x239)],{'cwd':_0x4da251,'stdio':_0x14666e(0x1b8),'env':_0x542d44}),(0x0,import_child_process[_0x14666e(0x1fe)])(_0x14666e(0x1b5),[_0x14666e(0x2a6),'origin',_0x5075da],{'cwd':_0x4da251,'stdio':_0x14666e(0x1b8),'env':_0x542d44});}catch(_0x41e68a){const _0x30b190=_0x41e68a instanceof Error?_0x41e68a['message']:String(_0x41e68a);throw new Error('Failed\x20to\x20reset\x20clone\x20at\x20'+_0x4da251+':\x20'+_0x30b190);}}function cloneRepo(_0x1cefb9,_0x19d676,_0x7170ec,_0x303939){const _0x5536e7=a4_0x20a9ce;_0x303939['log'](_0x5536e7(0x265)+_0x1cefb9+_0x5536e7(0x2ac)+_0x7170ec);const _0x3f2073=(0x0,import_path[_0x5536e7(0x1b4)])(_0x7170ec);!(0x0,import_fs[_0x5536e7(0x1b1)])(_0x3f2073)&&(0x0,import_fs['mkdirSync'])(_0x3f2073,{'recursive':!![]});const _0x301c86=_0x5536e7(0x1da)+_0x19d676+_0x5536e7(0x1c5)+_0x1cefb9+_0x5536e7(0x2c9);try{(0x0,import_child_process[_0x5536e7(0x1fe)])(_0x5536e7(0x1b5),[_0x5536e7(0x23b),_0x5536e7(0x207),'1',_0x301c86,_0x7170ec],{'stdio':_0x5536e7(0x1b8),'env':{...process[_0x5536e7(0x289)],'GIT_TERMINAL_PROMPT':'0'}});}catch(_0x5ce5e2){const _0x298d30=_0x5ce5e2 instanceof Error?_0x5ce5e2[_0x5536e7(0x196)]:String(_0x5ce5e2);throw new Error('Failed\x20to\x20clone\x20'+_0x1cefb9+':\x20'+sanitizeError(_0x298d30));}finally{try{(0x0,import_child_process[_0x5536e7(0x1fe)])(_0x5536e7(0x1b5),[_0x5536e7(0x2a3),'set-url',_0x5536e7(0x2a5),_0x5536e7(0x275)+_0x1cefb9+_0x5536e7(0x2c9)],{'cwd':_0x7170ec});}catch{}}}function checkoutSessionBranch(_0x224d00,_0x5ad7e3,_0x2923ef){const _0x18fc73=a4_0x20a9ce,_0x14276a=validateGitRef(_0x5ad7e3,_0x18fc73(0x2c8));if(_0x14276a)throw new Error(_0x14276a);_0x2923ef[_0x18fc73(0x2c6)]('Checking\x20out\x20session\x20branch\x20\x22'+_0x5ad7e3+_0x18fc73(0x1db)+_0x224d00);const _0x410667={...process[_0x18fc73(0x289)],'GIT_TERMINAL_PROMPT':'0'};try{(0x0,import_child_process[_0x18fc73(0x1fe)])(_0x18fc73(0x1b5),[_0x18fc73(0x284),'-B',_0x5ad7e3],{'cwd':_0x224d00,'stdio':_0x18fc73(0x1b8),'env':_0x410667});}catch(_0xb3daa0){const _0x11ae5=_0xb3daa0 instanceof Error?_0xb3daa0[_0x18fc73(0x196)]:String(_0xb3daa0);throw new Error('Failed\x20to\x20checkout\x20session\x20branch\x20\x22'+_0x5ad7e3+_0x18fc73(0x1db)+_0x224d00+':\x20'+_0x11ae5);}}function cloneOrResetRepo(_0x571907,_0x1a735d,_0x443b71,_0x506a17,_0x392c5c){const _0x5f425f=a4_0x20a9ce,_0x4adfcd=_0x571907['vcsConfiguration']['repositoryFullName'],_0x29bd9a=_0x4adfcd[_0x5f425f(0x1ec)]('/')[_0x5f425f(0x216)]()??_0x4adfcd,_0x5d6cac=getClonePath(_0x443b71,_0x29bd9a);if(_0x1a735d[_0x5f425f(0x1a3)]<Date[_0x5f425f(0x2be)]())throw new Error(_0x5f425f(0x1a9)+_0x571907[_0x5f425f(0x233)]+'\x20has\x20expired');const _0x197bf3=_0x506a17[_0x5f425f(0x22b)][_0x5f425f(0x292)](_0x2509d5=>_0x2509d5[_0x5f425f(0x299)]===_0x571907['id']);if(_0x197bf3&&isValidClone(_0x197bf3[_0x5f425f(0x20f)]))return resetCloneToCleanState(_0x197bf3[_0x5f425f(0x20f)],_0x571907[_0x5f425f(0x212)],_0x392c5c),checkoutSessionBranch(_0x197bf3[_0x5f425f(0x20f)],_0x443b71,_0x392c5c),_0x197bf3;return isValidClone(_0x5d6cac)?(_0x392c5c[_0x5f425f(0x2c6)](_0x5f425f(0x2a0)+_0x5d6cac+_0x5f425f(0x2c5)),resetCloneToCleanState(_0x5d6cac,_0x571907[_0x5f425f(0x212)],_0x392c5c)):cloneRepo(_0x4adfcd,_0x1a735d[_0x5f425f(0x205)],_0x5d6cac,_0x392c5c),checkoutSessionBranch(_0x5d6cac,_0x443b71,_0x392c5c),installDependencies(_0x5d6cac,_0x392c5c),{'workspaceId':_0x571907['id'],'repoFullName':_0x4adfcd,'localPath':_0x5d6cac,'defaultBranch':_0x571907[_0x5f425f(0x212)],'initiator':_0x571907[_0x5f425f(0x1cc)],'clonedAt':Date[_0x5f425f(0x2be)]()};}async function clonePolygraphRepositories(_0x9aea31,_0x4ef29f,_0x23fbf1){const _0x36b245=a4_0x20a9ce,{sessionId:_0x322c2c,workspaces:_0x240bed,credentials:_0x3aa9d8}=_0x23fbf1;try{await ensurePolygraphGitignore(_0x9aea31);const _0x20db05=getRegistryPath(_0x9aea31,_0x322c2c);let _0x150099=loadRepoRegistry(_0x20db05);!_0x150099&&(_0x150099={'sessionId':_0x322c2c,'createdAt':Date[_0x36b245(0x2be)](),'repos':[]});const _0x480012=[],_0x4f6e3d=_0x240bed[_0x36b245(0x292)](_0x56b947=>_0x56b947[_0x36b245(0x1cc)]);_0x4f6e3d&&_0x480012[_0x36b245(0x26f)]({'workspaceId':_0x4f6e3d['id'],'repoFullName':_0x4f6e3d['vcsConfiguration'][_0x36b245(0x29c)],'localPath':_0x9aea31,'defaultBranch':_0x4f6e3d[_0x36b245(0x212)],'initiator':!![],'clonedAt':Date['now']()});const _0x657542=_0x240bed[_0x36b245(0x242)](_0x4548ec=>!_0x4548ec[_0x36b245(0x1cc)]);for(const _0x310938 of _0x657542){const _0x293447=_0x3aa9d8[_0x36b245(0x292)](_0x260f32=>_0x260f32['workspaceId']===_0x310938['id']);if(!_0x293447)throw new Error(_0x36b245(0x26a)+_0x310938[_0x36b245(0x233)]+'\x20('+_0x310938['id']+')');const _0x4e41b4=cloneOrResetRepo(_0x310938,_0x293447,_0x322c2c,_0x150099,_0x4ef29f);_0x480012['push'](_0x4e41b4);}return _0x150099[_0x36b245(0x22b)]=_0x480012,saveRepoRegistry(_0x20db05,_0x150099),{'success':!![],'sessionId':_0x322c2c,'clones':_0x480012};}catch(_0x1f8c37){const _0x18ce33=_0x1f8c37 instanceof Error?_0x1f8c37['message']:String(_0x1f8c37);return _0x4ef29f[_0x36b245(0x2c6)](_0x36b245(0x20e)+_0x18ce33),{'success':![],'sessionId':_0x322c2c,'clones':[],'error':_0x18ce33};}}async function markPolygraphPRsReady(_0xf852df,_0x64202c){const _0x49d941=a4_0x20a9ce,_0x52e3db=_0x64202c['nxCloudUrl']+_0x49d941(0x227)+encodeURIComponent(_0x64202c[_0x49d941(0x266)])+_0x49d941(0x1d6),_0x51b99a={'Content-Type':_0x49d941(0x25b),..._0x64202c[_0x49d941(0x1dd)]};_0xf852df[_0x49d941(0x2c6)]('Marking\x20session\x20PRs\x20ready\x20from:\x20'+_0x52e3db);try{const _0x2526ef=new AbortController(),_0x330bea=setTimeout(()=>_0x2526ef['abort'](),POLYGRAPH_FETCH_TIMEOUT_MS),_0x1c0370=await fetch(_0x52e3db,{'method':_0x49d941(0x240),'headers':_0x51b99a,'body':JSON[_0x49d941(0x219)]({'prUrls':_0x64202c[_0x49d941(0x1e0)]}),'signal':_0x2526ef[_0x49d941(0x24b)]});clearTimeout(_0x330bea);const _0x151bd9=await _0x1c0370[_0x49d941(0x23c)]();if(!_0x1c0370['ok'])return _0xf852df['log'](_0x49d941(0x1ea)+_0x1c0370[_0x49d941(0x20b)]+'\x20'+_0x151bd9),{'success':![],'error':_0x49d941(0x215)+_0x1c0370[_0x49d941(0x20b)]+':\x20'+_0x151bd9};const _0x4d4b7d=JSON[_0x49d941(0x2c3)](_0x151bd9),_0x5e9aaa=_0x4d4b7d[_0x49d941(0x2bf)][_0x49d941(0x1f0)](_0x54f44c=>({'url':_0x54f44c[_0x49d941(0x236)],'number':_0x54f44c[_0x49d941(0x1d4)],'success':_0x54f44c['success'],'error':_0x54f44c['error']}));return _0xf852df[_0x49d941(0x2c6)]('Marked\x20'+_0x5e9aaa['filter'](_0x81f04f=>_0x81f04f[_0x49d941(0x255)])[_0x49d941(0x197)]+'/'+_0x5e9aaa['length']+_0x49d941(0x1dc)),{'success':!![],'results':_0x5e9aaa,'allSucceeded':_0x4d4b7d[_0x49d941(0x252)]};}catch(_0x6e727f){const _0x5b5515=_0x6e727f instanceof Error?_0x6e727f[_0x49d941(0x196)]:String(_0x6e727f);return _0xf852df[_0x49d941(0x2c6)](_0x49d941(0x1ea)+_0x5b5515),{'success':![],'error':_0x49d941(0x210)+_0x5b5515};}}var import_child_process2=require('child_process'),import_fs2=require('fs'),import_path2=require(a4_0x20a9ce(0x2a2));function ensureSandboxAndMCP(_0x26e421){const _0x5454c5=a4_0x20a9ce,_0x158396=(0x0,import_path2['join'])(_0x26e421,'.claude');!(0x0,import_fs2[_0x5454c5(0x1b1)])(_0x158396)&&(0x0,import_fs2[_0x5454c5(0x1d8)])(_0x158396,{'recursive':!![]});const _0xd7e8=(0x0,import_path2[_0x5454c5(0x1e7)])(_0x158396,_0x5454c5(0x248)),_0x3c0630={'extraKnownMarketplaces':{'nx-claude-plugins':{'source':{'source':_0x5454c5(0x22c),'repo':_0x5454c5(0x208)}}},'enabledPlugins':{'nx@nx-claude-plugins':!![]},'enableAllProjectMcpServers':!![],'enabledMcpjsonServers':['nx'],'mcpServers':{'nx-mcp':{'type':_0x5454c5(0x29a),'command':_0x5454c5(0x1c4),'args':[_0x5454c5(0x195),_0x5454c5(0x269)]}}};(0x0,import_fs2[_0x5454c5(0x24a)])(_0xd7e8,JSON[_0x5454c5(0x219)](_0x3c0630,null,0x2),'utf-8');}var POLYGRAPH_CHILD_SYSTEM_PROMPT=a4_0x20a9ce(0x29e),ChildAgentManager=class{constructor(_0x102e53){const _0x26de00=a4_0x20a9ce;this[_0x26de00(0x192)]=_0x102e53;}[a4_0x20a9ce(0x250)]=new Map();[a4_0x20a9ce(0x1ca)]=0x3;[a4_0x20a9ce(0x1c3)]=0x19*0x3c*0x3e8;[a4_0x20a9ce(0x19f)](_0x23748f,_0x543856,_0x372d9e,_0x2e5138){const _0x2dbb91=a4_0x20a9ce;let _0xdaed1f=this['agents'][_0x2dbb91(0x234)](_0x23748f);if((_0xdaed1f==null?void 0x0:_0xdaed1f[_0x2dbb91(0x20b)])===_0x2dbb91(0x1b0))return{'started':![],'error':_0x2dbb91(0x2c7)+_0x23748f+_0x2dbb91(0x1df)};!_0xdaed1f&&(_0xdaed1f={'workspaceId':_0x23748f,'repoPath':_0x543856,'process':null,'status':_0x2dbb91(0x2a7),'retryCount':0x0,'logFile':null,'currentInstruction':'','startedAt':null},this[_0x2dbb91(0x250)][_0x2dbb91(0x1ac)](_0x23748f,_0xdaed1f));if(_0xdaed1f[_0x2dbb91(0x218)]>=this[_0x2dbb91(0x1ca)])return{'started':![],'error':'Max\x20retries\x20('+this[_0x2dbb91(0x1ca)]+_0x2dbb91(0x29d)+_0x23748f};const _0x263aba=_0x2e5138?_0x2dbb91(0x1ee)+_0x2e5138+_0x2dbb91(0x2c2)+_0x372d9e:_0x372d9e;ensureSandboxAndMCP(_0x543856);const _0xe967cc=(0x0,import_path2[_0x2dbb91(0x1e7)])(_0x543856,'.nx');!(0x0,import_fs2[_0x2dbb91(0x1b1)])(_0xe967cc)&&(0x0,import_fs2['mkdirSync'])(_0xe967cc,{'recursive':!![]});const _0x1be5da=(0x0,import_path2[_0x2dbb91(0x1e7)])(_0xe967cc,_0x2dbb91(0x2bd));(0x0,import_fs2[_0x2dbb91(0x24a)])(_0x1be5da,'','utf-8'),_0xdaed1f[_0x2dbb91(0x1d9)]=_0x1be5da,_0xdaed1f[_0x2dbb91(0x1c1)]=_0x372d9e,_0xdaed1f[_0x2dbb91(0x1b3)]=Date[_0x2dbb91(0x2be)]();const _0x3dc506=(0x0,import_fs2[_0x2dbb91(0x286)])(_0x1be5da,{'flags':'a'}),_0x411c02=[_0x2dbb91(0x1e6),_0x2dbb91(0x1f3),_0x2dbb91(0x2b0),_0x2dbb91(0x257),_0x2dbb91(0x278),_0x2dbb91(0x1a6),_0x2dbb91(0x23e),POLYGRAPH_CHILD_SYSTEM_PROMPT];this[_0x2dbb91(0x192)][_0x2dbb91(0x2c6)]('Starting\x20task\x20in\x20'+_0x543856),this['logger']['log'](_0x2dbb91(0x2ca)+_0x263aba[_0x2dbb91(0x1b2)](0x0,0xc8)+_0x2dbb91(0x296)),_0xdaed1f[_0x2dbb91(0x20b)]=_0x2dbb91(0x1b0);const _0x4fc90a=(0x0,import_child_process2[_0x2dbb91(0x22d)])(_0x2dbb91(0x2bb),_0x411c02,{'cwd':_0x543856,'env':{...process[_0x2dbb91(0x289)]}});_0xdaed1f[_0x2dbb91(0x263)]=_0x4fc90a,_0x4fc90a['stdin'][_0x2dbb91(0x213)](_0x263aba),_0x4fc90a[_0x2dbb91(0x1ff)][_0x2dbb91(0x1f8)](),_0x4fc90a[_0x2dbb91(0x259)]['on'](_0x2dbb91(0x220),_0x16b710=>{const _0x327ff0=_0x2dbb91,_0x585218=_0x16b710[_0x327ff0(0x295)]();_0x3dc506['write'](_0x585218),this['logger'][_0x327ff0(0x2c6)]('['+_0x23748f+']\x20stdout:\x20'+_0x585218[_0x327ff0(0x1b2)](0x0,0x64)+(_0x585218[_0x327ff0(0x197)]>0x64?_0x327ff0(0x296):''));}),_0x4fc90a['stderr']['on']('data',_0x8e1230=>{const _0x15e9ad=_0x2dbb91,_0x14269a=_0x8e1230['toString']();_0x3dc506['write'](_0x15e9ad(0x191)+_0x14269a),this['logger'][_0x15e9ad(0x2c6)]('['+_0x23748f+']\x20stderr:\x20'+_0x14269a);});const _0x66250a=setTimeout(()=>{const _0x373a0c=_0x2dbb91;this['logger'][_0x373a0c(0x2c6)]('['+_0x23748f+_0x373a0c(0x2ab)+this['taskTimeout']+'ms'),_0x3dc506[_0x373a0c(0x1f8)](),_0x4fc90a[_0x373a0c(0x249)](),_0xdaed1f['status']=_0x373a0c(0x25c),_0xdaed1f['process']=null,_0xdaed1f['retryCount']++;},this[_0x2dbb91(0x1c3)]);return _0x4fc90a['on'](_0x2dbb91(0x193),_0x46f04d=>{const _0x2ab9f2=_0x2dbb91;clearTimeout(_0x66250a),_0x3dc506['end'](),_0xdaed1f[_0x2ab9f2(0x263)]=null,this[_0x2ab9f2(0x192)][_0x2ab9f2(0x2c6)]('['+_0x23748f+_0x2ab9f2(0x2b6)+_0x46f04d),_0x46f04d===0x0?(_0xdaed1f[_0x2ab9f2(0x20b)]=_0x2ab9f2(0x26e),_0xdaed1f[_0x2ab9f2(0x218)]=0x0):(_0xdaed1f[_0x2ab9f2(0x20b)]=_0x2ab9f2(0x25c),_0xdaed1f[_0x2ab9f2(0x218)]++);}),_0x4fc90a['on']('error',_0x494d14=>{const _0x219b00=_0x2dbb91;clearTimeout(_0x66250a),_0x3dc506['end'](),_0xdaed1f[_0x219b00(0x263)]=null,_0xdaed1f[_0x219b00(0x20b)]=_0x219b00(0x25c),_0xdaed1f[_0x219b00(0x218)]++,this[_0x219b00(0x192)][_0x219b00(0x2c6)]('['+_0x23748f+']\x20Spawn\x20error:\x20'+_0x494d14[_0x219b00(0x196)]);}),{'started':!![]};}['kill'](_0x39434e){const _0xa08745=a4_0x20a9ce,_0x4d71ac=this[_0xa08745(0x250)][_0xa08745(0x234)](_0x39434e);(_0x4d71ac==null?void 0x0:_0x4d71ac['process'])&&(this[_0xa08745(0x192)][_0xa08745(0x2c6)]('Killing\x20process\x20for\x20workspace\x20'+_0x39434e),_0x4d71ac[_0xa08745(0x263)][_0xa08745(0x249)](),_0x4d71ac['process']=null,_0x4d71ac[_0xa08745(0x20b)]='failed');}[a4_0x20a9ce(0x20d)](){const _0x5d9738=a4_0x20a9ce;this['logger']['log'](_0x5d9738(0x26d));for(const [_0x9155d8]of this[_0x5d9738(0x250)]){this['kill'](_0x9155d8);}}[a4_0x20a9ce(0x268)](){const _0x2edc4b=a4_0x20a9ce;this['logger'][_0x2edc4b(0x2c6)]('Resetting\x20all\x20child\x20agents');for(const [_0x58a562]of this['agents']){const _0x2a4b44=this[_0x2edc4b(0x250)]['get'](_0x58a562);(_0x2a4b44==null?void 0x0:_0x2a4b44[_0x2edc4b(0x263)])&&this[_0x2edc4b(0x291)](_0x58a562);}this[_0x2edc4b(0x250)][_0x2edc4b(0x25e)]();}[a4_0x20a9ce(0x291)](_0x52c331){const _0x3834c4=a4_0x20a9ce,_0x5ce633=this[_0x3834c4(0x250)][_0x3834c4(0x234)](_0x52c331);if(!_0x5ce633)return{'stopped':![],'output':''};let _0x1e7ba0='';if(_0x5ce633['logFile'])try{_0x1e7ba0=(0x0,import_fs2['readFileSync'])(_0x5ce633[_0x3834c4(0x1d9)],_0x3834c4(0x298));}catch{}if(_0x5ce633[_0x3834c4(0x263)]){this[_0x3834c4(0x192)][_0x3834c4(0x2c6)]('Stopping\x20child\x20for\x20workspace\x20'+_0x52c331),_0x5ce633['process'][_0x3834c4(0x249)](_0x3834c4(0x21e));const _0x4ceede=_0x5ce633[_0x3834c4(0x263)];setTimeout(()=>{const _0x134fbe=_0x3834c4;try{_0x4ceede[_0x134fbe(0x249)]('SIGKILL');}catch{}},0x1388),_0x5ce633['process']=null;}return _0x5ce633[_0x3834c4(0x20b)]=_0x3834c4(0x2b1),{'stopped':!![],'output':_0x1e7ba0};}[a4_0x20a9ce(0x272)](_0x587219,_0x514588){const _0x11c9b6=a4_0x20a9ce,_0xcea76=this[_0x11c9b6(0x250)]['get'](_0x587219);if(!(_0xcea76==null?void 0x0:_0xcea76[_0x11c9b6(0x1d9)]))return null;try{const _0x47c7f9=(0x0,import_fs2[_0x11c9b6(0x217)])(_0xcea76[_0x11c9b6(0x1d9)],_0x11c9b6(0x298));if(_0x514588&&_0x514588>0x0){const _0x40b6ae=_0x47c7f9[_0x11c9b6(0x1ec)]('\x0a');return _0x40b6ae[_0x11c9b6(0x1cd)](-_0x514588)[_0x11c9b6(0x1e7)]('\x0a');}return _0x47c7f9;}catch{return null;}}[a4_0x20a9ce(0x2ad)](){const _0xf960ec=a4_0x20a9ce,_0x5ae8e4=[];for(const _0xb94c45 of this['agents'][_0xf960ec(0x19c)]()){const _0x3df5e1=_0xb94c45[_0xf960ec(0x1b3)]&&_0xb94c45[_0xf960ec(0x20b)]==='running'?Date[_0xf960ec(0x2be)]()-_0xb94c45[_0xf960ec(0x1b3)]:_0xb94c45[_0xf960ec(0x1b3)]?Date[_0xf960ec(0x2be)]()-_0xb94c45[_0xf960ec(0x1b3)]:null;_0x5ae8e4['push']({'workspaceId':_0xb94c45[_0xf960ec(0x299)],'repoPath':_0xb94c45[_0xf960ec(0x1c6)],'status':_0xb94c45[_0xf960ec(0x20b)],'durationMs':_0x3df5e1,'instruction':_0xb94c45[_0xf960ec(0x1c1)]});}return _0x5ae8e4;}[a4_0x20a9ce(0x247)](){const _0x3c7928=a4_0x20a9ce;let _0x3f76cd=0x0;for(const _0x1ac822 of this['agents'][_0x3c7928(0x19c)]()){_0x1ac822[_0x3c7928(0x263)]!==null&&_0x3f76cd++;}return _0x3f76cd;}},import_child_process3=require(a4_0x20a9ce(0x1ce));async function getPolygraphCredentials(_0x4387a4,_0x40e751){const _0x31a753=a4_0x20a9ce,_0x1703ef=_0x40e751[_0x31a753(0x21a)]+'/nx-cloud/polygraph/session/'+encodeURIComponent(_0x40e751[_0x31a753(0x266)])+_0x31a753(0x26b),_0x31ab16={'Content-Type':_0x31a753(0x25b),..._0x40e751[_0x31a753(0x1dd)]};_0x4387a4[_0x31a753(0x2c6)](_0x31a753(0x1d7)+_0x1703ef);try{const _0x343496=new AbortController(),_0x4f508f=setTimeout(()=>_0x343496['abort'](),POLYGRAPH_FETCH_TIMEOUT_MS),_0x3c59f5=await fetch(_0x1703ef,{'method':_0x31a753(0x240),'headers':_0x31ab16,'signal':_0x343496[_0x31a753(0x24b)]});clearTimeout(_0x4f508f);const _0x41d01e=await _0x3c59f5[_0x31a753(0x23c)]();if(!_0x3c59f5['ok'])return _0x4387a4[_0x31a753(0x2c6)](_0x31a753(0x264)+_0x3c59f5['status']+'\x20'+_0x41d01e),{'success':![],'error':_0x31a753(0x270)+_0x3c59f5[_0x31a753(0x20b)]+':\x20'+_0x41d01e};const _0x485957=JSON[_0x31a753(0x2c3)](_0x41d01e);return _0x4387a4[_0x31a753(0x2c6)](_0x31a753(0x1f2)+_0x485957[_0x31a753(0x238)][_0x31a753(0x197)]+_0x31a753(0x293)),{'success':!![],'credentials':_0x485957[_0x31a753(0x238)]};}catch(_0x339e7e){const _0x31098f=_0x339e7e instanceof Error?_0x339e7e[_0x31a753(0x196)]:String(_0x339e7e);return _0x4387a4[_0x31a753(0x2c6)]('Failed\x20to\x20fetch\x20credentials:\x20'+_0x31098f),{'success':![],'error':_0x31a753(0x25f)+_0x31098f};}}function getDefaultBranch(_0x4bb2e8,_0x575fb3=a4_0x20a9ce(0x2b7)){const _0x5ab640=a4_0x20a9ce;try{const _0x1767e9=(0x0,import_child_process3[_0x5ab640(0x27d)])(_0x5ab640(0x21c),{'cwd':_0x4bb2e8,'stdio':_0x5ab640(0x1b8),'env':{...process[_0x5ab640(0x289)],'GIT_TERMINAL_PROMPT':'0'}})[_0x5ab640(0x295)]()[_0x5ab640(0x1d2)](),_0x4f766c=_0x1767e9[_0x5ab640(0x1ec)]('/');return _0x4f766c[_0x5ab640(0x197)]>0x1?_0x4f766c['slice'](0x1)[_0x5ab640(0x1e7)]('/'):_0x575fb3;}catch{return _0x575fb3;}}function parseRemoteUrl(_0x4a481e){const _0x265ab9=a4_0x20a9ce,_0x5602f0=_0x4a481e['match'](/https?:\/\/[^/]*github\.com\/([^/]+)\/([^/]+?)(\.git)?$/);if(_0x5602f0)return{'owner':_0x5602f0[0x1],'repo':_0x5602f0[0x2]};const _0x1bd7ac=_0x4a481e[_0x265ab9(0x280)](/git@github\.com:([^/]+)\/(.+?)(\.git)?$/);if(_0x1bd7ac)return{'owner':_0x1bd7ac[0x1],'repo':_0x1bd7ac[0x2]};return null;}async function pushPolygraphBranch(_0x269e84,_0x3b31dc){const _0x2dffd9=a4_0x20a9ce,_0x45729a={...process['env'],'GIT_TERMINAL_PROMPT':'0'},_0x1c75b8=getRegistryPath(_0x3b31dc[_0x2dffd9(0x21b)],_0x3b31dc['sessionId']),_0x499b58=loadRepoRegistry(_0x1c75b8);if(!_0x499b58)return _0x269e84[_0x2dffd9(0x2c6)]('No\x20repo\x20registry\x20found\x20for\x20session\x20'+_0x3b31dc[_0x2dffd9(0x266)]),{'success':![],'error':_0x2dffd9(0x20a)+_0x3b31dc[_0x2dffd9(0x266)],'phase':_0x2dffd9(0x1fa)};const _0x486ffa=_0x499b58[_0x2dffd9(0x22b)][_0x2dffd9(0x292)](_0xe12a41=>_0xe12a41[_0x2dffd9(0x20f)]===_0x3b31dc[_0x2dffd9(0x1c6)]);if(!_0x486ffa)return _0x269e84[_0x2dffd9(0x2c6)](_0x2dffd9(0x203)+_0x3b31dc[_0x2dffd9(0x1c6)]+'\x20not\x20found\x20in\x20repo\x20registry'),{'success':![],'error':_0x2dffd9(0x203)+_0x3b31dc[_0x2dffd9(0x1c6)]+_0x2dffd9(0x224),'phase':'validation'};_0x269e84[_0x2dffd9(0x2c6)](_0x2dffd9(0x1b6)+_0x486ffa['repoFullName']+'\x20(workspace:\x20'+_0x486ffa[_0x2dffd9(0x299)]+')');const _0xfe8b29=await getPolygraphCredentials(_0x269e84,{'sessionId':_0x3b31dc['sessionId'],'nxCloudUrl':_0x3b31dc[_0x2dffd9(0x21a)],'authHeaders':_0x3b31dc[_0x2dffd9(0x1dd)]});if(!_0xfe8b29[_0x2dffd9(0x255)])return _0x269e84[_0x2dffd9(0x2c6)](_0x2dffd9(0x221)+_0xfe8b29[_0x2dffd9(0x214)]),{'success':![],'error':_0x2dffd9(0x221)+_0xfe8b29[_0x2dffd9(0x214)],'phase':_0x2dffd9(0x238)};const _0x26c005=_0xfe8b29[_0x2dffd9(0x238)][_0x2dffd9(0x292)](_0x3f44b6=>_0x3f44b6[_0x2dffd9(0x299)]===_0x486ffa[_0x2dffd9(0x299)]);if(!_0x26c005)return _0x269e84[_0x2dffd9(0x2c6)](_0x2dffd9(0x26a)+_0x486ffa[_0x2dffd9(0x299)]),{'success':![],'error':_0x2dffd9(0x26a)+_0x486ffa[_0x2dffd9(0x299)],'phase':_0x2dffd9(0x238)};_0x269e84[_0x2dffd9(0x2c6)](_0x2dffd9(0x2c0)+_0x486ffa['workspaceId']);const [_0x416a5a,_0x1b5360]=_0x486ffa['repoFullName'][_0x2dffd9(0x1ec)]('/');try{const _0x218281=(0x0,import_child_process3[_0x2dffd9(0x27d)])(_0x2dffd9(0x1c0),{'cwd':_0x3b31dc[_0x2dffd9(0x1c6)],'stdio':_0x2dffd9(0x1b8),'env':_0x45729a})[_0x2dffd9(0x295)]()['trim']();_0x269e84[_0x2dffd9(0x2c6)](_0x2dffd9(0x277)+_0x218281);const _0x25ce2e=parseRemoteUrl(_0x218281);if(!_0x25ce2e)return{'success':![],'error':_0x2dffd9(0x228)+_0x218281,'phase':_0x2dffd9(0x1fa)};if(_0x25ce2e[_0x2dffd9(0x241)][_0x2dffd9(0x1af)]()!==_0x416a5a[_0x2dffd9(0x1af)]()||_0x25ce2e[_0x2dffd9(0x23a)][_0x2dffd9(0x1af)]()!==_0x1b5360[_0x2dffd9(0x1af)]())return _0x269e84[_0x2dffd9(0x2c6)]('Remote\x20mismatch:\x20expected\x20'+_0x416a5a+'/'+_0x1b5360+',\x20got\x20'+_0x25ce2e[_0x2dffd9(0x241)]+'/'+_0x25ce2e[_0x2dffd9(0x23a)]),{'success':![],'error':_0x2dffd9(0x1bf)+_0x416a5a+'/'+_0x1b5360,'phase':_0x2dffd9(0x1fa)};}catch(_0xf6a0e1){const _0x134601=_0xf6a0e1 instanceof Error?_0xf6a0e1[_0x2dffd9(0x196)]:String(_0xf6a0e1);return _0x269e84[_0x2dffd9(0x2c6)](_0x2dffd9(0x2aa)+sanitizeError(_0x134601)),{'success':![],'error':_0x2dffd9(0x2cb)+sanitizeError(_0x134601),'phase':_0x2dffd9(0x1fa)};}const _0x346189=validateGitRef(_0x3b31dc[_0x2dffd9(0x24d)],'Branch\x20name');if(_0x346189)return{'success':![],'error':_0x346189,'phase':'validation'};const _0x8e074f=getDefaultBranch(_0x3b31dc[_0x2dffd9(0x1c6)]),_0x281217=validateGitRef(_0x8e074f,'Base\x20branch');if(_0x281217)return{'success':![],'error':_0x281217,'phase':_0x2dffd9(0x1fa)};_0x269e84[_0x2dffd9(0x2c6)](_0x2dffd9(0x29f)+_0x8e074f);try{const _0x18a199=(0x0,import_child_process3['execFileSync'])(_0x2dffd9(0x1b5),[_0x2dffd9(0x2a1),_0x2dffd9(0x1fd),_0x2dffd9(0x1f6)+_0x8e074f+_0x2dffd9(0x1f9)],{'cwd':_0x3b31dc[_0x2dffd9(0x1c6)],'stdio':_0x2dffd9(0x1b8),'env':_0x45729a})['toString']()[_0x2dffd9(0x1d2)]();if(_0x18a199==='0')return _0x269e84[_0x2dffd9(0x2c6)](_0x2dffd9(0x285)),{'success':![],'error':'No\x20commits\x20ahead\x20of\x20base\x20branch\x20--\x20nothing\x20to\x20push','phase':'validation'};_0x269e84[_0x2dffd9(0x2c6)](_0x18a199+_0x2dffd9(0x230)+_0x8e074f);}catch(_0x54c77c){const _0x181a86=_0x54c77c instanceof Error?_0x54c77c[_0x2dffd9(0x196)]:String(_0x54c77c);return _0x269e84[_0x2dffd9(0x2c6)](_0x2dffd9(0x27c)+sanitizeError(_0x181a86)),{'success':![],'error':'Failed\x20to\x20check\x20commits\x20ahead:\x20'+sanitizeError(_0x181a86),'phase':_0x2dffd9(0x1fa)};}const _0x169dec='https://x-access-token:'+_0x26c005[_0x2dffd9(0x205)]+_0x2dffd9(0x1c5)+_0x416a5a+'/'+_0x1b5360+_0x2dffd9(0x2c9);_0x269e84[_0x2dffd9(0x2c6)](_0x2dffd9(0x1a4)+_0x3b31dc[_0x2dffd9(0x24d)]+_0x2dffd9(0x1ba));try{(0x0,import_child_process3[_0x2dffd9(0x1fe)])(_0x2dffd9(0x1b5),[_0x2dffd9(0x26f),'--force-with-lease',_0x169dec,_0x2dffd9(0x245)+_0x3b31dc[_0x2dffd9(0x24d)]],{'cwd':_0x3b31dc['repoPath'],'stdio':_0x2dffd9(0x1b8),'env':_0x45729a}),_0x269e84['log']('Successfully\x20pushed\x20'+_0x3b31dc['branch']);}catch(_0x4cc1cb){const _0xb14202=_0x4cc1cb instanceof Error?_0x4cc1cb[_0x2dffd9(0x196)]:String(_0x4cc1cb),_0x542d9d=sanitizeError(_0xb14202);return _0x269e84[_0x2dffd9(0x2c6)](_0x2dffd9(0x204)+_0x542d9d),{'success':![],'error':_0x2dffd9(0x26c)+_0x542d9d,'phase':_0x2dffd9(0x26f)};}return{'success':!![],'branch':_0x3b31dc['branch'],'remote':'origin'};}async function polygraphInit(_0x18366e,_0x4f1c1d){const _0x4b4e83=a4_0x20a9ce,{sessionId:_0x79f8e9,nxCloudId:_0x53f7b4,nxCloudUrl:_0x442bb3,authHeaders:_0x54d2ce,workspacePath:_0x96fddd}=_0x4f1c1d,_0x320d26=await initPolygraphSession(_0x18366e,{'sessionId':_0x79f8e9,'nxCloudId':_0x53f7b4,'nxCloudUrl':_0x442bb3,'authHeaders':_0x54d2ce});if(_0x320d26['error'])return{'success':![],'error':_0x4b4e83(0x19d)+_0x320d26['error'][_0x4b4e83(0x196)]+_0x4b4e83(0x231)+_0x320d26['url']};const _0x4fecd1=_0x320d26[_0x4b4e83(0x220)];if(!(_0x4fecd1==null?void 0x0:_0x4fecd1[_0x4b4e83(0x28f)])||_0x4fecd1[_0x4b4e83(0x28f)][_0x4b4e83(0x197)]===0x0)return{'success':!![],'sessionId':_0x79f8e9,'clonesSummary':_0x4b4e83(0x288)+_0x79f8e9};const _0x3e2d96=await clonePolygraphRepositories(_0x96fddd,_0x18366e,_0x4fecd1);if(!_0x3e2d96[_0x4b4e83(0x255)])return{'success':![],'error':_0x4b4e83(0x20e)+_0x3e2d96['error']};const _0x2fed4e=_0x3e2d96[_0x4b4e83(0x2af)][_0x4b4e83(0x1f0)](_0x404dcd=>'-\x20'+_0x404dcd['repoFullName']+':\x20'+_0x404dcd['localPath'])['join']('\x0a');return{'success':!![],'sessionId':_0x79f8e9,'clonesSummary':_0x4b4e83(0x202)+_0x79f8e9+_0x4b4e83(0x1b9)+_0x2fed4e+_0x4b4e83(0x1e5)};}var childAgentManager;function getChildAgentManager(_0x2dc723){const _0x59c119=a4_0x20a9ce;if(!childAgentManager){childAgentManager=new ChildAgentManager(_0x2dc723);const _0x553818=()=>childAgentManager[_0x59c119(0x20d)]();process['on'](_0x59c119(0x1a7),_0x553818),process['on'](_0x59c119(0x2cd),_0x553818),process['on'](_0x59c119(0x21e),_0x553818);}return childAgentManager;}function polygraphDelegate(_0xf20250,_0x44fc1d){const _0x4bc7c7=a4_0x20a9ce,_0x414a6b=getChildAgentManager(_0xf20250),{sessionId:_0x1bd851,target:_0xbbaa78,instruction:_0x49eb9e,context:_0x1d42aa,workspacePath:_0xc7d192}=_0x44fc1d,_0x19c6a6=getRegistryPath(_0xc7d192,_0x1bd851),_0x1d2428=loadRepoRegistry(_0x19c6a6);if(!_0x1d2428)return{'success':![],'error':'No\x20Polygraph\x20session\x20found\x20with\x20ID:\x20'+_0x1bd851+_0x4bc7c7(0x281)};const _0x50a877=_0x1d2428[_0x4bc7c7(0x22b)][_0x4bc7c7(0x292)](_0x1dc2bc=>_0x1dc2bc[_0x4bc7c7(0x299)]===_0xbbaa78||_0x1dc2bc[_0x4bc7c7(0x1a0)]===_0xbbaa78||_0x1dc2bc[_0x4bc7c7(0x1a0)][_0x4bc7c7(0x1f7)]('/'+_0xbbaa78));if(!_0x50a877){const _0x26e614=_0x1d2428[_0x4bc7c7(0x22b)][_0x4bc7c7(0x1f0)](_0xd57b6a=>{const _0x21e632=_0x4bc7c7,_0xc0c6ad=_0xd57b6a[_0x21e632(0x1a0)][_0x21e632(0x1ec)]('/')[_0x21e632(0x216)]()??_0xd57b6a['repoFullName'];return _0xc0c6ad+'\x20('+_0xd57b6a[_0x21e632(0x1a0)]+')';})[_0x4bc7c7(0x1e7)](',\x20');return{'success':![],'error':'Repository\x20\x22'+_0xbbaa78+_0x4bc7c7(0x200)+_0x1bd851+'.\x0aAvailable\x20repositories:\x20'+_0x26e614};}_0xf20250[_0x4bc7c7(0x2c6)](_0x4bc7c7(0x1a8)+_0x50a877[_0x4bc7c7(0x1a0)]+_0x4bc7c7(0x1e9)+_0x50a877[_0x4bc7c7(0x20f)]);const _0x24125e=_0x414a6b[_0x4bc7c7(0x19f)](_0x50a877[_0x4bc7c7(0x299)],_0x50a877[_0x4bc7c7(0x20f)],_0x49eb9e,_0x1d42aa);return _0x24125e[_0x4bc7c7(0x198)]?{'success':!![],'message':_0x4bc7c7(0x290)+_0x50a877[_0x4bc7c7(0x1a0)]+_0x4bc7c7(0x273)}:{'success':![],'error':_0x24125e['error']};}async function polygraphPushBranch(_0x4ae8bd,_0x36c132){const _0x15ee8a=a4_0x20a9ce,_0x214fbc=await pushPolygraphBranch(_0x4ae8bd,_0x36c132);if(!_0x214fbc[_0x15ee8a(0x255)])return{'success':![],'error':_0x214fbc['error']};return{'success':!![],'branch':_0x214fbc[_0x15ee8a(0x24d)]};}async function saveSessionPlan(_0x2ed679,_0x37d906,_0x3498f4,_0x221a0a,_0x1f8ff8,_0x4f447d){const _0x48ceca=a4_0x20a9ce;try{const _0x50d01f=_0x37d906+_0x48ceca(0x227)+_0x221a0a+_0x48ceca(0x1bb),_0x5d7272=new AbortController(),_0x14f571=setTimeout(()=>_0x5d7272[_0x48ceca(0x25d)](),POLYGRAPH_FETCH_TIMEOUT_MS);await fetch(_0x50d01f,{'method':'POST','headers':{'Content-Type':'application/json',..._0x3498f4},'body':JSON[_0x48ceca(0x219)]({'plan':_0x1f8ff8,'agentSessionId':_0x4f447d}),'signal':_0x5d7272['signal']}),clearTimeout(_0x14f571);}catch(_0x4151ca){_0x2ed679[_0x48ceca(0x2c6)](_0x48ceca(0x1a5)+(_0x4151ca instanceof Error?_0x4151ca[_0x48ceca(0x196)]:String(_0x4151ca)));}}async function polygraphCreatePRs(_0xbd38ea,_0x3b6bc2){const _0x191efe=a4_0x20a9ce,_0x439cf2=[],_0x14829e=getRegistryPath(_0x3b6bc2['workspacePath'],_0x3b6bc2[_0x191efe(0x266)]),_0x24f153=loadRepoRegistry(_0x14829e);if(!_0x24f153)return{'success':![],'error':_0x191efe(0x20a)+_0x3b6bc2[_0x191efe(0x266)]};for(const _0x454303 of _0x3b6bc2[_0x191efe(0x2b2)]){const {owner:_0x1941d6,repo:_0x23cbd5}=_0x454303,_0x4300f1=_0x24f153[_0x191efe(0x22b)]['find'](_0x16302a=>_0x16302a[_0x191efe(0x1a0)]===_0x1941d6+'/'+_0x23cbd5);if(!_0x4300f1){_0x439cf2['push']({'owner':_0x1941d6,'repo':_0x23cbd5,'success':![],'error':_0x191efe(0x203)+_0x1941d6+'/'+_0x23cbd5+_0x191efe(0x224)});continue;}try{const _0x13cb5a=await createPolygraphPR(_0xbd38ea,{'sessionId':_0x3b6bc2[_0x191efe(0x266)],'nxCloudUrl':_0x3b6bc2[_0x191efe(0x21a)],'authHeaders':_0x3b6bc2[_0x191efe(0x1dd)],'title':_0x454303[_0x191efe(0x211)],'body':_0x454303['body'],'headBranch':_0x454303[_0x191efe(0x271)],'baseBranch':_0x454303['baseBranch'],'workspaceId':_0x4300f1['workspaceId']});_0x13cb5a[_0x191efe(0x255)]?_0x439cf2[_0x191efe(0x26f)]({'owner':_0x1941d6,'repo':_0x23cbd5,'success':!![],'url':_0x13cb5a['url'],'number':_0x13cb5a[_0x191efe(0x1d1)],'title':_0x13cb5a[_0x191efe(0x211)]}):_0x439cf2[_0x191efe(0x26f)]({'owner':_0x1941d6,'repo':_0x23cbd5,'success':![],'error':_0x13cb5a[_0x191efe(0x214)]});}catch(_0x20bb41){const _0x1dc3ba=_0x20bb41 instanceof Error?_0x20bb41[_0x191efe(0x196)]:String(_0x20bb41);_0x439cf2[_0x191efe(0x26f)]({'owner':_0x1941d6,'repo':_0x23cbd5,'success':![],'error':_0x1dc3ba});}}return _0x3b6bc2[_0x191efe(0x2b3)]&&saveSessionPlan(_0xbd38ea,_0x3b6bc2[_0x191efe(0x21a)],_0x3b6bc2[_0x191efe(0x1dd)],_0x3b6bc2['sessionId'],_0x3b6bc2[_0x191efe(0x2b3)],_0x3b6bc2[_0x191efe(0x1c9)]),{'success':!![],'results':_0x439cf2};}async function polygraphGetSession(_0x5d8f93,_0x324adb){return await getPolygraphSession(_0x5d8f93,_0x324adb);}function formatPrCiStatus(_0x5d0e9c,_0x4d3159){const _0xb3273a=a4_0x20a9ce,_0x81abcf=_0x4d3159[_0x5d0e9c['id']];if(!_0x81abcf||!_0x81abcf['status'])return _0xb3273a(0x1ae);const _0x1a6159=[_0xb3273a(0x1e3)+_0x81abcf['status']];return _0x81abcf['cipeUrl']&&_0x1a6159[_0xb3273a(0x26f)](_0xb3273a(0x256)+_0x81abcf[_0xb3273a(0x1a2)]),_0x1a6159[_0xb3273a(0x1e7)]('\x0a');}function formatPolygraphSession(_0xad9b65){const _0x546ef9=a4_0x20a9ce;var _0x3cafe4;const _0x212d7c=[];_0x212d7c[_0x546ef9(0x26f)](_0x546ef9(0x253)+_0xad9b65[_0x546ef9(0x266)]),_0x212d7c[_0x546ef9(0x26f)](_0x546ef9(0x2c4)+_0xad9b65[_0x546ef9(0x2c1)]),_0x212d7c[_0x546ef9(0x26f)]('Status:\x20'+(_0xad9b65[_0x546ef9(0x26e)]?_0x546ef9(0x26e):'active')),_0x212d7c[_0x546ef9(0x26f)]('');if(_0xad9b65[_0x546ef9(0x28f)][_0x546ef9(0x197)]>0x0){_0x212d7c['push'](_0x546ef9(0x28d));for(const _0xfb2ecc of _0xad9b65[_0x546ef9(0x28f)]){const _0x316350=((_0x3cafe4=_0xfb2ecc['vcsConfiguration'])==null?void 0x0:_0x3cafe4[_0x546ef9(0x29c)])??_0xfb2ecc[_0x546ef9(0x233)],_0x5c7bfa=_0xfb2ecc[_0x546ef9(0x1cc)]?'\x20(initiator)':'';_0x212d7c[_0x546ef9(0x26f)]('-\x20'+_0x316350+_0x5c7bfa);}_0x212d7c[_0x546ef9(0x26f)]('');}if(_0xad9b65[_0x546ef9(0x24c)][_0x546ef9(0x197)]>0x0){_0x212d7c['push'](_0x546ef9(0x23d));for(const _0x4943c0 of _0xad9b65[_0x546ef9(0x24c)]){_0x212d7c[_0x546ef9(0x26f)]('-\x20'+_0x4943c0['title']+'\x20['+_0x4943c0['status']+']'),_0x212d7c[_0x546ef9(0x26f)](_0x546ef9(0x1e1)+_0x4943c0['branch']),_0x212d7c['push'](_0x546ef9(0x206)+_0x4943c0[_0x546ef9(0x1d3)]),_0x212d7c[_0x546ef9(0x26f)](formatPrCiStatus(_0x4943c0,_0xad9b65[_0x546ef9(0x19e)]??{}));}_0x212d7c[_0x546ef9(0x26f)]('');}if(_0xad9b65[_0x546ef9(0x225)]['nodes'][_0x546ef9(0x197)]>0x0||_0xad9b65['dependencyGraph'][_0x546ef9(0x1a1)][_0x546ef9(0x197)]>0x0){_0x212d7c['push'](_0x546ef9(0x1e2)),_0x212d7c[_0x546ef9(0x26f)]('\x20\x20Nodes:\x20'+_0xad9b65[_0x546ef9(0x225)][_0x546ef9(0x2bc)][_0x546ef9(0x1e7)](',\x20'));for(const _0x32c1d1 of _0xad9b65[_0x546ef9(0x225)][_0x546ef9(0x1a1)]){_0x212d7c['push']('\x20\x20'+_0x32c1d1[_0x546ef9(0x226)]+_0x546ef9(0x2a9)+_0x32c1d1[_0x546ef9(0x28e)]);}}return _0x212d7c[_0x546ef9(0x1e7)]('\x0a');}async function polygraphMarkReady(_0xb68b5d,_0x763147){const _0x32d5a4=a4_0x20a9ce,_0x207f98=await markPolygraphPRsReady(_0xb68b5d,_0x763147);return _0x763147[_0x32d5a4(0x2b3)]&&saveSessionPlan(_0xb68b5d,_0x763147[_0x32d5a4(0x21a)],_0x763147[_0x32d5a4(0x1dd)],_0x763147[_0x32d5a4(0x266)],_0x763147[_0x32d5a4(0x2b3)],_0x763147[_0x32d5a4(0x1c9)]),_0x207f98;}async function polygraphAssociatePR(_0x3e870a,_0x5adf0f){const _0x1e8248=a4_0x20a9ce,_0x29b560=await associatePolygraphPR(_0x3e870a,_0x5adf0f);return _0x5adf0f[_0x1e8248(0x2b3)]&&saveSessionPlan(_0x3e870a,_0x5adf0f['nxCloudUrl'],_0x5adf0f[_0x1e8248(0x1dd)],_0x5adf0f[_0x1e8248(0x266)],_0x5adf0f[_0x1e8248(0x2b3)],_0x5adf0f[_0x1e8248(0x1c9)]),_0x29b560;}async function polygraphStopChild(_0x560f5f,_0x524b42){const _0x2bf26f=a4_0x20a9ce,_0x45eb82=getChildAgentManager(_0x560f5f),{sessionId:_0x88eb96,target:_0x2965d4,workspacePath:_0x58ac17}=_0x524b42,_0x9f0434=getRegistryPath(_0x58ac17,_0x88eb96),_0x2e56f2=loadRepoRegistry(_0x9f0434);if(!_0x2e56f2)return{'success':![],'error':_0x2bf26f(0x20a)+_0x88eb96+_0x2bf26f(0x281)};const _0x1401d9=_0x2e56f2[_0x2bf26f(0x22b)][_0x2bf26f(0x292)](_0x22a720=>_0x22a720[_0x2bf26f(0x299)]===_0x2965d4||_0x22a720['repoFullName']===_0x2965d4||_0x22a720[_0x2bf26f(0x1a0)]['endsWith']('/'+_0x2965d4));if(!_0x1401d9){const _0x1cd21b=_0x2e56f2[_0x2bf26f(0x22b)][_0x2bf26f(0x1f0)](_0x247d43=>{const _0x556bb3=_0x2bf26f,_0x2a3922=_0x247d43[_0x556bb3(0x1a0)][_0x556bb3(0x1ec)]('/')[_0x556bb3(0x216)]()??_0x247d43['repoFullName'];return _0x2a3922+'\x20('+_0x247d43['repoFullName']+')';})[_0x2bf26f(0x1e7)](',\x20');return{'success':![],'error':_0x2bf26f(0x27f)+_0x2965d4+_0x2bf26f(0x200)+_0x88eb96+_0x2bf26f(0x283)+_0x1cd21b};}_0x560f5f[_0x2bf26f(0x2c6)](_0x2bf26f(0x1fb)+_0x1401d9[_0x2bf26f(0x1a0)]);const _0x4ce3b2=_0x45eb82[_0x2bf26f(0x291)](_0x1401d9[_0x2bf26f(0x299)]);if(!_0x4ce3b2['stopped'])return{'success':![],'error':_0x2bf26f(0x27b)+_0x1401d9['repoFullName']};return{'success':!![],'output':_0x4ce3b2[_0x2bf26f(0x21f)],'message':_0x2bf26f(0x235)+_0x1401d9[_0x2bf26f(0x1a0)]+_0x2bf26f(0x1f5)};}async function polygraphChildStatus(_0x322fe4,_0x191baf){const _0x4b42e3=a4_0x20a9ce,_0x2d7a3c=getChildAgentManager(_0x322fe4),{sessionId:_0x17bc0c,target:_0xe1c58d,workspacePath:_0x2afdc9,tail:tail=0x32}=_0x191baf,_0x528555=getRegistryPath(_0x2afdc9,_0x17bc0c),_0x55dc02=loadRepoRegistry(_0x528555);if(!_0x55dc02)return{'success':![],'error':_0x4b42e3(0x20a)+_0x17bc0c+_0x4b42e3(0x281)};const _0x4fc1ca=_0x2d7a3c[_0x4b42e3(0x2ad)](),_0xfa666c=[];for(const _0x1f546c of _0x4fc1ca){const _0x3111f2=_0x55dc02['repos']['find'](_0x12fc0d=>_0x12fc0d[_0x4b42e3(0x299)]===_0x1f546c[_0x4b42e3(0x299)]);if(!_0x3111f2)continue;if(_0xe1c58d&&_0x1f546c[_0x4b42e3(0x299)]!==_0xe1c58d&&_0x3111f2[_0x4b42e3(0x1a0)]!==_0xe1c58d&&!_0x3111f2[_0x4b42e3(0x1a0)][_0x4b42e3(0x1f7)]('/'+_0xe1c58d))continue;const _0x458d7c=_0x2d7a3c[_0x4b42e3(0x272)](_0x1f546c[_0x4b42e3(0x299)],tail)??'';_0xfa666c[_0x4b42e3(0x26f)]({'workspaceId':_0x1f546c[_0x4b42e3(0x299)],'repoFullName':_0x3111f2[_0x4b42e3(0x1a0)],'status':_0x1f546c['status'],'lastOutputLines':_0x458d7c,'durationMs':_0x1f546c['durationMs'],'instruction':_0x1f546c[_0x4b42e3(0x1bc)]});}if(_0xe1c58d&&_0xfa666c[_0x4b42e3(0x197)]===0x0)return{'success':![],'error':'No\x20child\x20agent\x20found\x20for\x20target\x20\x22'+_0xe1c58d+_0x4b42e3(0x279)+_0x17bc0c+'.'};return{'success':!![],'children':_0xfa666c};}0x0&&(module[a4_0x20a9ce(0x251)]={'formatPolygraphSession':formatPolygraphSession,'polygraphAssociatePR':polygraphAssociatePR,'polygraphChildStatus':polygraphChildStatus,'polygraphCreatePRs':polygraphCreatePRs,'polygraphDelegate':polygraphDelegate,'polygraphGetSession':polygraphGetSession,'polygraphInit':polygraphInit,'polygraphMarkReady':polygraphMarkReady,'polygraphPushBranch':polygraphPushBranch,'polygraphStopChild':polygraphStopChild});