'use strict';const a4_0x22f9f2=a4_0x337c;(function(_0x2fc881,_0x5f0e7f){const _0xa9ef62=a4_0x337c,_0x27536a=_0x2fc881();while(!![]){try{const _0x27eaec=-parseInt(_0xa9ef62(0x267))/0x1*(-parseInt(_0xa9ef62(0x24a))/0x2)+-parseInt(_0xa9ef62(0x28e))/0x3+parseInt(_0xa9ef62(0x289))/0x4*(parseInt(_0xa9ef62(0x27e))/0x5)+-parseInt(_0xa9ef62(0x291))/0x6+-parseInt(_0xa9ef62(0x253))/0x7+parseInt(_0xa9ef62(0x29c))/0x8*(-parseInt(_0xa9ef62(0x22b))/0x9)+parseInt(_0xa9ef62(0x21c))/0xa;if(_0x27eaec===_0x5f0e7f)break;else _0x27536a['push'](_0x27536a['shift']());}catch(_0x382539){_0x27536a['push'](_0x27536a['shift']());}}}(a4_0x4865,0x44374));var __defProp=Object[a4_0x22f9f2(0x281)],__getOwnPropDesc=Object[a4_0x22f9f2(0x222)],__getOwnPropNames=Object['getOwnPropertyNames'],__hasOwnProp=Object[a4_0x22f9f2(0x26a)][a4_0x22f9f2(0x25b)],__export=(_0x57dc5f,_0x1f1605)=>{for(var _0x3c345d in _0x1f1605)__defProp(_0x57dc5f,_0x3c345d,{'get':_0x1f1605[_0x3c345d],'enumerable':!![]});},__copyProps=(_0x4ed3b7,_0x51a0c2,_0x365853,_0x2bf0ed)=>{const _0x4b491f=a4_0x22f9f2;if(_0x51a0c2&&typeof _0x51a0c2===_0x4b491f(0x283)||typeof _0x51a0c2===_0x4b491f(0x24f)){for(let _0x582333 of __getOwnPropNames(_0x51a0c2))if(!__hasOwnProp[_0x4b491f(0x20e)](_0x4ed3b7,_0x582333)&&_0x582333!==_0x365853)__defProp(_0x4ed3b7,_0x582333,{'get':()=>_0x51a0c2[_0x582333],'enumerable':!(_0x2bf0ed=__getOwnPropDesc(_0x51a0c2,_0x582333))||_0x2bf0ed[_0x4b491f(0x243)]});}return _0x4ed3b7;},__toCommonJS=_0x2fe028=>__copyProps(__defProp({},a4_0x22f9f2(0x29e),{'value':!![]}),_0x2fe028),polygraph_handlers_exports={};__export(polygraph_handlers_exports,{'polygraphDelegate':()=>polygraphDelegate,'polygraphInit':()=>polygraphInit}),module[a4_0x22f9f2(0x245)]=__toCommonJS(polygraph_handlers_exports);var import_child_process=require(a4_0x22f9f2(0x249)),import_fs=require('fs'),import_os=require('os'),import_path=require(a4_0x22f9f2(0x1fa));async function initPolygraphSession(_0x19b505,_0x260c38){const _0x51a90d=a4_0x22f9f2;var _0x300578;const _0x126669=_0x260c38['nxCloudUrl']+_0x51a90d(0x223),_0x128855={'Content-Type':_0x51a90d(0x205),..._0x260c38[_0x51a90d(0x231)]},_0x4a5ff2=JSON[_0x51a90d(0x252)]({'sessionId':_0x260c38[_0x51a90d(0x250)],'workspaceId':_0x260c38[_0x51a90d(0x1f2)],'additionalContext':''});_0x19b505[_0x51a90d(0x202)](_0x51a90d(0x20a)+_0x126669),_0x19b505[_0x51a90d(0x202)]('Request\x20headers:\x20'+JSON[_0x51a90d(0x252)](_0x128855,null,0x2)),_0x19b505[_0x51a90d(0x202)](_0x51a90d(0x288)+_0x4a5ff2);try{const _0x51cf73=new AbortController(),_0x308dc6=setTimeout(()=>_0x51cf73['abort'](),0x2710),_0x20cde0=await fetch(_0x126669,{'method':'POST','headers':_0x128855,'body':_0x4a5ff2,'signal':_0x51cf73['signal']});clearTimeout(_0x308dc6);const _0x9dcba2=await _0x20cde0[_0x51a90d(0x233)]();if(!_0x20cde0['ok']){if(_0x20cde0['status']===0x191)return _0x19b505['log'](_0x51a90d(0x251)+_0x9dcba2),{'url':_0x126669,'error':{'type':_0x51a90d(0x201),'message':_0x9dcba2}};return _0x19b505['log'](_0x51a90d(0x25a)+_0x20cde0[_0x51a90d(0x294)]+'\x20'+_0x9dcba2),{'url':_0x126669,'error':{'type':_0x51a90d(0x286),'message':_0x9dcba2}};}const _0x28edc9=JSON[_0x51a90d(0x278)](_0x9dcba2);return(_0x300578=_0x19b505[_0x51a90d(0x240)])==null?void 0x0:_0x300578[_0x51a90d(0x20e)](_0x19b505,_0x51a90d(0x211)+JSON[_0x51a90d(0x252)](_0x28edc9)),{'url':_0x126669,'data':_0x28edc9};}catch(_0x52097d){const _0x3f6b97=_0x52097d instanceof Error?_0x52097d[_0x51a90d(0x1fd)]:String(_0x52097d);return _0x19b505[_0x51a90d(0x202)]('Network\x20error:\x20'+_0x3f6b97),{'url':_0x126669,'error':{'type':_0x51a90d(0x26f),'message':_0x3f6b97}};}}function getCloneRegistryPath(_0x2806e5,_0x213373){const _0x11a367=a4_0x22f9f2;return(0x0,import_path[_0x11a367(0x235)])(_0x2806e5,_0x11a367(0x20c),_0x11a367(0x230),_0x213373,_0x11a367(0x242));}async function ensurePolygraphGitignore(_0x57ff6f){const _0x53b965=a4_0x22f9f2,_0x5e7687=(0x0,import_path[_0x53b965(0x235)])(_0x57ff6f,'.gitignore');if(!(0x0,import_fs[_0x53b965(0x221)])(_0x5e7687))return;const _0xa461b2=(0x0,import_fs[_0x53b965(0x203)])(_0x5e7687,_0x53b965(0x265)),_0x40fcd9=_0xa461b2[_0x53b965(0x26c)]('\x0a');if(_0x40fcd9[_0x53b965(0x225)](_0x4f1fcb=>_0x4f1fcb[_0x53b965(0x209)]()===_0x53b965(0x20c)||_0x4f1fcb[_0x53b965(0x209)]()===_0x53b965(0x1f7)))return;const _0x29bc2c=_0xa461b2[_0x53b965(0x236)]('\x0a')?_0xa461b2+'.nx/\x0a':_0xa461b2+_0x53b965(0x22e);(0x0,import_fs[_0x53b965(0x204)])(_0x5e7687,_0x29bc2c,_0x53b965(0x265));}function loadCloneRegistry(_0x695f32){const _0x3263da=a4_0x22f9f2;if(!(0x0,import_fs[_0x3263da(0x221)])(_0x695f32))return null;try{const _0x5d2912=(0x0,import_fs[_0x3263da(0x203)])(_0x695f32,_0x3263da(0x265));return JSON[_0x3263da(0x278)](_0x5d2912);}catch{return null;}}function saveCloneRegistry(_0x47d8fa,_0x29a338){const _0xee6af0=a4_0x22f9f2,_0x2b1835=(0x0,import_path[_0xee6af0(0x20d)])(_0x47d8fa);!(0x0,import_fs['existsSync'])(_0x2b1835)&&(0x0,import_fs[_0xee6af0(0x24e)])(_0x2b1835,{'recursive':!![]}),(0x0,import_fs[_0xee6af0(0x204)])(_0x47d8fa,JSON[_0xee6af0(0x252)](_0x29a338,null,0x2),_0xee6af0(0x265));}function a4_0x4865(){const _0x12c540=['\x20in\x20',']\x20Task\x20timed\x20out\x20after\x20','Failed\x20to\x20clone\x20repositories:\x20','\x0aURL:\x20','12702040EWfQjS','\x0a\x0aUse\x20cloud_polygraph_coordinate\x20to\x20execute\x20tasks\x20across\x20these\x20repositories.','push','_id','resetSession','existsSync','getOwnPropertyDescriptor','/nx-cloud/polygraph/init-session','claude','some','toString','--print','repoFullName','data','yarn.lock','2058633MhgOly','.claude','hasExistingSession','\x0a.nx/\x0a','\x0a\x0aCloned\x20repositories:\x0a','polygraph','authHeaders','bun.lockb','text','taskTimeout','join','endsWith','close','write','getStatus','substring','SIGINT','pipe','Cloning\x20','spawn','agents','debug','Dependencies\x20installed\x20successfully','workspace.json','enumerable','git\x20checkout\x20','exports','process','Delegating\x20task\x20to\x20','Failed\x20to\x20spawn\x20Claude:\x20','child_process','2rSAubm','Invalid\x20branch\x20name:\x20','token','maxRetries','mkdirSync','function','sessionId','Authentication\x20error:\x20','stringify','1416177okKDLP','failed','get','Using\x20--continue\x20for\x20workspace\x20','Executing\x20task\x20in\x20','clones','activeCount','Error:\x20','hasOwnProperty','logger','Repository\x20\x22','killAll','https://x-access-token:',')\x20exceeded\x20for\x20workspace\x20','now','Context:\x20','values',']\x20Claude\x20exited\x20with\x20code\x20','utf-8','\x20to\x20','65522seKJGS','url','retryCount','prototype','workspaceId','split','\x20install','pop','network','\x22\x20not\x20found\x20in\x20session\x20','env','Session\x20initialized\x20but\x20no\x20workspaces\x20returned.\x0aSession\x20ID:\x20','\x0astderr:\x20','find','completed','\x20seconds','git\x20pull\x20origin\x20','parse','bun','execSync','length','Task\x20timed\x20out\x20after\x20','Resetting\x20clone\x20at\x20','5IgZYJz','--continue','Session\x20initialized\x20successfully.\x0aSession\x20ID:\x20','defineProperty','settings.json','object','pnpm','@github.com/','other','kill','Request\x20body:\x20','1318584MDtetE','defaultBranch','running','git\x20rev-parse\x20--git-dir','SIGTERM','1393446UlNCMU','Max\x20retries\x20(','name','2942580mGZVur','end','workspaces','status','output','pnpm-lock.yaml','stdin','\x20at\x20','x-access-token:***@','git\x20reset\x20--hard','yarn','8LjSHPK','.\x20Run\x20cloud_polygraph_init\x20first.','__esModule','Killing\x20all\x20child\x20agent\x20processes','error','nxCloudId','No\x20Polygraph\x20session\x20found\x20with\x20ID:\x20','Failed\x20to\x20reset\x20clone\x20at\x20','Starting\x20new\x20session\x20for\x20workspace\x20','Failed\x20to\x20install\x20dependencies\x20with\x20','.nx/','pending','npm','path','Claude\x20exited\x20with\x20code\x20','Prompt:\x20','message','unshift','stdout','set','authentication','log','readFileSync','writeFileSync','application/json',']\x20stdout:\x20','Killing\x20process\x20for\x20workspace\x20','\x0a\x0aTask:\x20','trim','Making\x20polygraph\x20init-session\x20request\x20to:\x20','Failed\x20to\x20clone\x20','.nx','dirname','call','exit','tmpdir','Polygraph\x20init-session\x20response:\x20','executeTask','Reset\x20session\x20state\x20for\x20workspace\x20','--dangerously-skip-permissions','expiresAt','replace','localPath'];a4_0x4865=function(){return _0x12c540;};return a4_0x4865();}function getClonePath(_0x712589,_0x2c3356){const _0x395692=a4_0x22f9f2;return(0x0,import_path['join'])((0x0,import_os[_0x395692(0x210)])(),'polygraph',_0x712589,_0x2c3356);}function isValidClone(_0x4ec789){const _0x1772d9=a4_0x22f9f2;if(!(0x0,import_fs[_0x1772d9(0x221)])(_0x4ec789))return![];try{return(0x0,import_child_process['execSync'])(_0x1772d9(0x28c),{'cwd':_0x4ec789,'stdio':'pipe'}),!![];}catch{return![];}}function detectPackageManager(_0x24c183){const _0x398e83=a4_0x22f9f2;if((0x0,import_fs[_0x398e83(0x221)])((0x0,import_path['join'])(_0x24c183,_0x398e83(0x296))))return _0x398e83(0x284);if((0x0,import_fs[_0x398e83(0x221)])((0x0,import_path[_0x398e83(0x235)])(_0x24c183,_0x398e83(0x22a))))return _0x398e83(0x29b);if((0x0,import_fs[_0x398e83(0x221)])((0x0,import_path[_0x398e83(0x235)])(_0x24c183,_0x398e83(0x232))))return _0x398e83(0x279);return _0x398e83(0x1f9);}function installDependencies(_0x3a4de8,_0x4d992b){const _0x16701d=a4_0x22f9f2,_0x480635=detectPackageManager(_0x3a4de8),_0x5131cc=_0x480635===_0x16701d(0x1f9)?'npm\x20install':_0x480635+_0x16701d(0x26d);_0x4d992b[_0x16701d(0x202)]('Installing\x20dependencies\x20with\x20'+_0x480635+_0x16701d(0x218)+_0x3a4de8);try{(0x0,import_child_process['execSync'])(_0x5131cc,{'cwd':_0x3a4de8,'stdio':_0x16701d(0x23c),'env':{...process[_0x16701d(0x271)]}}),_0x4d992b[_0x16701d(0x202)](_0x16701d(0x241));}catch(_0x38473a){const _0x4a47a5=_0x38473a instanceof Error?_0x38473a[_0x16701d(0x1fd)]:String(_0x38473a);throw new Error(_0x16701d(0x1f6)+_0x480635+':\x20'+_0x4a47a5);}}function a4_0x337c(_0x101750,_0x431798){const _0x48650e=a4_0x4865();return a4_0x337c=function(_0x337c8e,_0x323843){_0x337c8e=_0x337c8e-0x1f2;let _0x24f189=_0x48650e[_0x337c8e];return _0x24f189;},a4_0x337c(_0x101750,_0x431798);}function resetCloneToCleanState(_0x786f2,_0x2b0bde,_0xaf79ba){const _0x1c4b7b=a4_0x22f9f2;_0xaf79ba['log'](_0x1c4b7b(0x27d)+_0x786f2+_0x1c4b7b(0x266)+_0x2b0bde);const _0x5a2642={...process[_0x1c4b7b(0x271)],'GIT_TERMINAL_PROMPT':'0'};try{const _0x1276b1=_0x2b0bde[_0x1c4b7b(0x216)](/[^a-zA-Z0-9/_-]/g,'');if(_0x1276b1!==_0x2b0bde)throw new Error(_0x1c4b7b(0x24b)+_0x2b0bde);(0x0,import_child_process[_0x1c4b7b(0x27a)])(_0x1c4b7b(0x244)+_0x1276b1,{'cwd':_0x786f2,'stdio':_0x1c4b7b(0x23c),'env':_0x5a2642}),(0x0,import_child_process[_0x1c4b7b(0x27a)])(_0x1c4b7b(0x29a),{'cwd':_0x786f2,'stdio':_0x1c4b7b(0x23c),'env':_0x5a2642}),(0x0,import_child_process[_0x1c4b7b(0x27a)])('git\x20clean\x20-fd',{'cwd':_0x786f2,'stdio':'pipe','env':_0x5a2642}),(0x0,import_child_process[_0x1c4b7b(0x27a)])(_0x1c4b7b(0x277)+_0x1276b1,{'cwd':_0x786f2,'stdio':'pipe','env':_0x5a2642});}catch(_0x1c2786){const _0x21b539=_0x1c2786 instanceof Error?_0x1c2786[_0x1c4b7b(0x1fd)]:String(_0x1c2786);throw new Error(_0x1c4b7b(0x1f4)+_0x786f2+':\x20'+_0x21b539);}}function cloneRepo(_0x3b245a,_0xd01d3a,_0x4d13fc,_0x563b35){const _0x1a557c=a4_0x22f9f2;_0x563b35['log'](_0x1a557c(0x23d)+_0x3b245a+_0x1a557c(0x266)+_0x4d13fc);const _0x5893a2=(0x0,import_path[_0x1a557c(0x20d)])(_0x4d13fc);!(0x0,import_fs[_0x1a557c(0x221)])(_0x5893a2)&&(0x0,import_fs[_0x1a557c(0x24e)])(_0x5893a2,{'recursive':!![]});const _0x5811c7=_0x1a557c(0x25f)+_0xd01d3a+_0x1a557c(0x285)+_0x3b245a+'.git';try{(0x0,import_child_process[_0x1a557c(0x27a)])('git\x20clone\x20'+_0x5811c7+'\x20'+_0x4d13fc,{'stdio':'pipe','env':{...process[_0x1a557c(0x271)],'GIT_TERMINAL_PROMPT':'0'}});}catch(_0x32a76c){const _0x1dc413=_0x32a76c instanceof Error?_0x32a76c[_0x1a557c(0x1fd)]:String(_0x32a76c),_0x572efe=_0x1dc413['replace'](/x-access-token:[^@]+@/g,_0x1a557c(0x299));throw new Error(_0x1a557c(0x20b)+_0x3b245a+':\x20'+_0x572efe);}}function cloneOrResetRepo(_0x213478,_0x28ae4c,_0x22fa71,_0x1d4082,_0x3e4ab0){const _0xa90d9c=a4_0x22f9f2,_0x2691a3=_0x213478['vcsConfiguration']['repositoryFullName'],_0x51122a=_0x2691a3[_0xa90d9c(0x26c)]('/')[_0xa90d9c(0x26e)]()??_0x2691a3,_0x4aca07=getClonePath(_0x22fa71,_0x51122a);if(_0x28ae4c[_0xa90d9c(0x215)]<Date['now']())throw new Error('Credential\x20for\x20workspace\x20'+_0x213478[_0xa90d9c(0x290)]+'\x20has\x20expired');const _0x539af6=_0x1d4082['clones'][_0xa90d9c(0x274)](_0x42c0be=>_0x42c0be['workspaceId']===_0x213478[_0xa90d9c(0x21f)]);if(_0x539af6&&isValidClone(_0x539af6[_0xa90d9c(0x217)]))return resetCloneToCleanState(_0x539af6[_0xa90d9c(0x217)],_0x213478[_0xa90d9c(0x28a)],_0x3e4ab0),_0x539af6;return cloneRepo(_0x2691a3,_0x28ae4c[_0xa90d9c(0x24c)],_0x4aca07,_0x3e4ab0),installDependencies(_0x4aca07,_0x3e4ab0),{'workspaceId':_0x213478[_0xa90d9c(0x21f)],'repoFullName':_0x2691a3,'localPath':_0x4aca07,'defaultBranch':_0x213478[_0xa90d9c(0x28a)],'clonedAt':Date['now']()};}async function clonePolygraphRepositories(_0x4788f3,_0xf3be95,_0x3b9b6a){const _0x3dc683=a4_0x22f9f2,{sessionId:_0x92ee02,workspaces:_0x48f163,credentials:_0xab56a6}=_0x3b9b6a;try{await ensurePolygraphGitignore(_0x4788f3);const _0x19481b=getCloneRegistryPath(_0x4788f3,_0x92ee02);let _0x473c64=loadCloneRegistry(_0x19481b);!_0x473c64&&(_0x473c64={'sessionId':_0x92ee02,'createdAt':Date[_0x3dc683(0x261)](),'clones':[]});const _0x3bf14c=[];for(const _0x1ab5d7 of _0x48f163){const _0x58b199=_0xab56a6[_0x3dc683(0x274)](_0xf53c5b=>_0xf53c5b[_0x3dc683(0x26b)]===_0x1ab5d7[_0x3dc683(0x21f)]);if(!_0x58b199)throw new Error('No\x20credential\x20found\x20for\x20workspace\x20'+_0x1ab5d7['name']+'\x20('+_0x1ab5d7[_0x3dc683(0x21f)]+')');const _0x35cf95=cloneOrResetRepo(_0x1ab5d7,_0x58b199,_0x92ee02,_0x473c64,_0xf3be95);_0x3bf14c[_0x3dc683(0x21e)](_0x35cf95);}return _0x473c64['clones']=_0x3bf14c,saveCloneRegistry(_0x19481b,_0x473c64),{'success':!![],'sessionId':_0x92ee02,'clones':_0x3bf14c};}catch(_0x23f2c5){const _0x18a1d1=_0x23f2c5 instanceof Error?_0x23f2c5[_0x3dc683(0x1fd)]:String(_0x23f2c5);return _0xf3be95['log'](_0x3dc683(0x21a)+_0x18a1d1),{'success':![],'sessionId':_0x92ee02,'clones':[],'error':_0x18a1d1};}}var import_child_process2=require(a4_0x22f9f2(0x249)),import_fs2=require('fs'),import_path2=require(a4_0x22f9f2(0x1fa));function ensureSandboxSettings(_0x502966){const _0x150568=a4_0x22f9f2,_0x491a31=(0x0,import_path2[_0x150568(0x235)])(_0x502966,_0x150568(0x22c));!(0x0,import_fs2[_0x150568(0x221)])(_0x491a31)&&(0x0,import_fs2[_0x150568(0x24e)])(_0x491a31,{'recursive':!![]});const _0x57a26b=(0x0,import_path2[_0x150568(0x235)])(_0x491a31,_0x150568(0x282)),_0x30bf33={'sandbox':{'enabled':!![],'autoAllowBashIfSandboxed':!![],'allowUnsandboxedCommands':![]}};(0x0,import_fs2['writeFileSync'])(_0x57a26b,JSON['stringify'](_0x30bf33,null,0x2),_0x150568(0x265));}var ChildAgentManager=class{constructor(_0x25ccb3){this['logger']=_0x25ccb3;}[a4_0x22f9f2(0x23f)]=new Map();[a4_0x22f9f2(0x24d)]=0x3;[a4_0x22f9f2(0x234)]=0x5*0x3c*0x3e8;async['executeTask'](_0x474c7f,_0x52c54f,_0x2bc032,_0x2aa016,_0x9b7476){const _0x422145=a4_0x22f9f2;let _0x2de222=this[_0x422145(0x23f)]['get'](_0x474c7f);!_0x2de222&&(_0x2de222={'workspaceId':_0x474c7f,'repoPath':_0x52c54f,'process':null,'status':_0x422145(0x1f8),'hasExistingSession':![],'retryCount':0x0},this['agents'][_0x422145(0x200)](_0x474c7f,_0x2de222));if(_0x2de222[_0x422145(0x269)]>=this['maxRetries'])return{'status':'failed','output':'','error':_0x422145(0x28f)+this['maxRetries']+_0x422145(0x260)+_0x474c7f};const _0x2ecb74=_0x2aa016?_0x422145(0x262)+_0x2aa016+_0x422145(0x208)+_0x2bc032:_0x2bc032;ensureSandboxSettings(_0x52c54f);const _0x37e256=[_0x422145(0x227),_0x422145(0x214)];return _0x2de222['hasExistingSession']?(_0x37e256[_0x422145(0x1fe)](_0x422145(0x27f)),this[_0x422145(0x25c)][_0x422145(0x202)](_0x422145(0x256)+_0x474c7f)):this['logger'][_0x422145(0x202)](_0x422145(0x1f5)+_0x474c7f),this['logger'][_0x422145(0x202)](_0x422145(0x257)+_0x52c54f),this['logger'][_0x422145(0x202)](_0x422145(0x1fc)+_0x2ecb74['substring'](0x0,0xc8)+'...'),new Promise(_0x2e1136=>{const _0x12e57c=_0x422145;_0x2de222[_0x12e57c(0x294)]=_0x12e57c(0x28b);const _0x457776=(0x0,import_child_process2[_0x12e57c(0x23e)])(_0x12e57c(0x224),_0x37e256,{'cwd':_0x52c54f,'env':{...process[_0x12e57c(0x271)]}});_0x2de222[_0x12e57c(0x246)]=_0x457776;let _0x1f2319='',_0x542a03='';_0x457776[_0x12e57c(0x297)][_0x12e57c(0x238)](_0x2ecb74),_0x457776[_0x12e57c(0x297)][_0x12e57c(0x292)](),_0x457776[_0x12e57c(0x1ff)]['on']('data',_0x32c7ba=>{const _0x3d34cc=_0x12e57c,_0x1a43a7=_0x32c7ba[_0x3d34cc(0x226)]();_0x1f2319+=_0x1a43a7,this['logger'][_0x3d34cc(0x202)]('['+_0x474c7f+_0x3d34cc(0x206)+_0x1a43a7[_0x3d34cc(0x23a)](0x0,0x64)+(_0x1a43a7[_0x3d34cc(0x27b)]>0x64?'...':'')),_0x9b7476==null?void 0x0:_0x9b7476(_0x1a43a7);}),_0x457776['stderr']['on'](_0x12e57c(0x229),_0x527521=>{const _0x44e631=_0x12e57c,_0x58117f=_0x527521['toString']();_0x542a03+=_0x58117f,this[_0x44e631(0x25c)]['log']('['+_0x474c7f+']\x20stderr:\x20'+_0x58117f);});const _0x45357c=setTimeout(()=>{const _0x3c39f4=_0x12e57c;this['logger'][_0x3c39f4(0x202)]('['+_0x474c7f+_0x3c39f4(0x219)+this[_0x3c39f4(0x234)]+'ms'),_0x457776['kill'](),_0x2de222[_0x3c39f4(0x294)]='failed',_0x2de222[_0x3c39f4(0x246)]=null,_0x2de222[_0x3c39f4(0x269)]++,_0x2e1136({'status':'failed','output':_0x1f2319,'error':_0x3c39f4(0x27c)+this[_0x3c39f4(0x234)]/0x3e8+_0x3c39f4(0x276)});},this[_0x12e57c(0x234)]);_0x457776['on'](_0x12e57c(0x237),_0x4589c5=>{const _0x3df03d=_0x12e57c;clearTimeout(_0x45357c),_0x2de222['process']=null,this[_0x3df03d(0x25c)]['log']('['+_0x474c7f+_0x3df03d(0x264)+_0x4589c5),_0x4589c5===0x0?(_0x2de222[_0x3df03d(0x22d)]=!![],_0x2de222[_0x3df03d(0x294)]=_0x3df03d(0x275),_0x2de222['retryCount']=0x0,_0x2e1136({'status':_0x3df03d(0x275),'output':_0x1f2319})):(_0x2de222[_0x3df03d(0x294)]=_0x3df03d(0x254),_0x2de222[_0x3df03d(0x269)]++,_0x2e1136({'status':_0x3df03d(0x254),'output':_0x1f2319,'error':_0x3df03d(0x1fb)+_0x4589c5+(_0x542a03?_0x3df03d(0x273)+_0x542a03:'')}));}),_0x457776['on'](_0x12e57c(0x2a0),_0x1736c5=>{const _0x3f9cf4=_0x12e57c;clearTimeout(_0x45357c),_0x2de222[_0x3f9cf4(0x246)]=null,_0x2de222[_0x3f9cf4(0x294)]=_0x3f9cf4(0x254),_0x2de222[_0x3f9cf4(0x269)]++,this['logger'][_0x3f9cf4(0x202)]('['+_0x474c7f+']\x20Spawn\x20error:\x20'+_0x1736c5[_0x3f9cf4(0x1fd)]),_0x2e1136({'status':'failed','output':_0x1f2319,'error':_0x3f9cf4(0x248)+_0x1736c5[_0x3f9cf4(0x1fd)]});});});}['isHealthy'](_0x92ce3){const _0x4e7b1d=a4_0x22f9f2,_0x295ef9=this['agents'][_0x4e7b1d(0x255)](_0x92ce3);if(!_0x295ef9)return!![];return _0x295ef9[_0x4e7b1d(0x269)]<this[_0x4e7b1d(0x24d)];}[a4_0x22f9f2(0x239)](_0x3bc3ff){const _0xae781d=a4_0x22f9f2,_0x3ba77a=this[_0xae781d(0x23f)][_0xae781d(0x255)](_0x3bc3ff);return(_0x3ba77a==null?void 0x0:_0x3ba77a[_0xae781d(0x294)])??null;}[a4_0x22f9f2(0x287)](_0x4fbfea){const _0x1c224c=a4_0x22f9f2,_0x3c8b2e=this[_0x1c224c(0x23f)][_0x1c224c(0x255)](_0x4fbfea);(_0x3c8b2e==null?void 0x0:_0x3c8b2e[_0x1c224c(0x246)])&&(this[_0x1c224c(0x25c)][_0x1c224c(0x202)](_0x1c224c(0x207)+_0x4fbfea),_0x3c8b2e['process'][_0x1c224c(0x287)](),_0x3c8b2e[_0x1c224c(0x246)]=null,_0x3c8b2e['status']=_0x1c224c(0x254));}[a4_0x22f9f2(0x25e)](){const _0x49a7ab=a4_0x22f9f2;this['logger'][_0x49a7ab(0x202)](_0x49a7ab(0x29f));for(const [_0x1318c1]of this['agents']){this[_0x49a7ab(0x287)](_0x1318c1);}}[a4_0x22f9f2(0x220)](_0x5ac13a){const _0x2c7e35=a4_0x22f9f2,_0x279f30=this[_0x2c7e35(0x23f)][_0x2c7e35(0x255)](_0x5ac13a);_0x279f30&&(_0x279f30[_0x2c7e35(0x22d)]=![],_0x279f30[_0x2c7e35(0x269)]=0x0,_0x279f30[_0x2c7e35(0x294)]=_0x2c7e35(0x1f8),this['logger']['log'](_0x2c7e35(0x213)+_0x5ac13a));}[a4_0x22f9f2(0x259)](){const _0x416fd8=a4_0x22f9f2;let _0x43a675=0x0;for(const _0x4f53ff of this['agents'][_0x416fd8(0x263)]()){_0x4f53ff['process']!==null&&_0x43a675++;}return _0x43a675;}};async function polygraphInit(_0x50fb34,_0x80cf08){const _0x1f627b=a4_0x22f9f2,{sessionId:_0x1db4df,nxCloudId:_0x41c276,nxCloudUrl:_0x48dcfd,authHeaders:_0x2ce165,workspacePath:_0x593054}=_0x80cf08,_0x50b795=await initPolygraphSession(_0x50fb34,{'sessionId':_0x1db4df,'nxCloudId':_0x41c276,'nxCloudUrl':_0x48dcfd,'authHeaders':_0x2ce165});if(_0x50b795['error'])return{'success':![],'error':'Failed\x20to\x20initialize\x20Polygraph\x20session:\x20'+_0x50b795[_0x1f627b(0x2a0)][_0x1f627b(0x1fd)]+_0x1f627b(0x21b)+_0x50b795[_0x1f627b(0x268)]};const _0x5a6a75=_0x50b795['data'];if(!(_0x5a6a75==null?void 0x0:_0x5a6a75['workspaces'])||_0x5a6a75[_0x1f627b(0x293)][_0x1f627b(0x27b)]===0x0)return{'success':!![],'sessionId':_0x1db4df,'clonesSummary':_0x1f627b(0x272)+_0x1db4df};const _0xc9107=await clonePolygraphRepositories(_0x593054,_0x50fb34,_0x5a6a75);if(!_0xc9107['success'])return{'success':![],'error':_0x1f627b(0x21a)+_0xc9107[_0x1f627b(0x2a0)]};const _0x51de73=_0xc9107[_0x1f627b(0x258)]['map'](_0xc7efd7=>'-\x20'+_0xc7efd7['repoFullName']+':\x20'+_0xc7efd7['localPath'])[_0x1f627b(0x235)]('\x0a');return{'success':!![],'sessionId':_0x1db4df,'clonesSummary':_0x1f627b(0x280)+_0x1db4df+_0x1f627b(0x22f)+_0x51de73+_0x1f627b(0x21d)};}var childAgentManager;function getChildAgentManager(_0x167ff3){const _0x2972d5=a4_0x22f9f2;if(!childAgentManager){childAgentManager=new ChildAgentManager(_0x167ff3);const _0x433c48=()=>childAgentManager['killAll']();process['on'](_0x2972d5(0x20f),_0x433c48),process['on'](_0x2972d5(0x23b),_0x433c48),process['on'](_0x2972d5(0x28d),_0x433c48);}return childAgentManager;}async function polygraphDelegate(_0x227d1a,_0x313322){const _0x3f63f1=a4_0x22f9f2,_0x5a340f=getChildAgentManager(_0x227d1a),{sessionId:_0x4d53c2,target:_0x32388a,instruction:_0x4ab35c,context:_0x3f4a94,workspacePath:_0x653ca6}=_0x313322,_0x2bbf4b=getCloneRegistryPath(_0x653ca6,_0x4d53c2),_0x2fb7f6=loadCloneRegistry(_0x2bbf4b);if(!_0x2fb7f6)return{'success':![],'error':_0x3f63f1(0x1f3)+_0x4d53c2+_0x3f63f1(0x29d)};const _0x2719dd=_0x2fb7f6[_0x3f63f1(0x258)]['find'](_0x3fb115=>_0x3fb115[_0x3f63f1(0x26b)]===_0x32388a||_0x3fb115['repoFullName']===_0x32388a||_0x3fb115[_0x3f63f1(0x228)][_0x3f63f1(0x236)]('/'+_0x32388a));if(!_0x2719dd){const _0x5d0c00=_0x2fb7f6['clones']['map'](_0xe20cb6=>{const _0x47774a=_0x3f63f1,_0x5eef8b=_0xe20cb6[_0x47774a(0x228)]['split']('/')[_0x47774a(0x26e)]()??_0xe20cb6['repoFullName'];return _0x5eef8b+'\x20('+_0xe20cb6['repoFullName']+')';})[_0x3f63f1(0x235)](',\x20');return{'success':![],'error':_0x3f63f1(0x25d)+_0x32388a+_0x3f63f1(0x270)+_0x4d53c2+'.\x0aAvailable\x20repositories:\x20'+_0x5d0c00};}_0x227d1a[_0x3f63f1(0x202)](_0x3f63f1(0x247)+_0x2719dd[_0x3f63f1(0x228)]+_0x3f63f1(0x298)+_0x2719dd[_0x3f63f1(0x217)]);const _0x53f393=await _0x5a340f[_0x3f63f1(0x212)](_0x2719dd[_0x3f63f1(0x26b)],_0x2719dd[_0x3f63f1(0x217)],_0x4ab35c,_0x3f4a94);return _0x53f393[_0x3f63f1(0x294)]===_0x3f63f1(0x275)?{'success':!![],'output':_0x53f393[_0x3f63f1(0x295)]}:{'success':![],'error':'Task\x20failed:\x20'+_0x53f393[_0x3f63f1(0x2a0)]+'\x0a\x0aPartial\x20output:\x0a'+_0x53f393['output']};}0x0&&(module[a4_0x22f9f2(0x245)]={'polygraphDelegate':polygraphDelegate,'polygraphInit':polygraphInit});